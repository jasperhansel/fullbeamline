\chapter{Tao Line Mode Commands}
\label{c:command}

\tao has two \vn{modes} for entering commands. In \vn{Line Mode}, described in this
chapter, \tao waits until the \vn{return} key is depressed to execute a command. That is,
a command consists of a single line of input. Conversely, \vn{Single Mode}, which is
described in Chapter~\sref{c:single}, interprets each keystroke as a command. Single Mode
is useful for quickly varying parameters to see how they affect a lattice but the number
of commands in Single Mode is limited. To put \tao into \vn{single mode} use the
\vn{single_mode} command (\sref{s:sing}).

\index{commands!Command List} 
Commands are case sensitive. The list of commands is shown in
Table~\ref{t:commands}. Multiple commands may be entered on one line using the semicolon
``;'' character as a separator.  [However, a semicolon used as as part of an \vn{alias}
(\sref{s:alias}) definition is part of that definition.]  An exclamation mark ``\vn{!}''
denotes the beginning of a comment and the exclamation mark and everything after it to the
end of the line is ignored.  Example:
\begin{example}
  set default uni = 2; show global  ! Two commands and a comment
\end{example}

This chapter uses the following special characters to define the command line syntax:
\begin{example}
  \{\}        ! Identifies an optional argument. 
              !   Arguments now enclosed in brackets are required
  <>        ! Indicates a non-literal argument.
\end{example}

Example:
\begin{example}
  change \{-silent\} variable <name>[<locations>] <number>
\end{example}
Here the \vn{-silent} argument is optional while the \vn{variable} argument is
mandatory. Appropriate values for \vn{<name>}, \vn{<locations>}, and \vn{<number>} must be
substituted. A possible

\begin{example}
  change var steering[34:36] @1e-3  ! set the steering strength #34-36 to 0.001
\end{example}

%% command_table -----------------------------------------------------

\begin{table}[h]
\centering {\tt
\begin{tabular}{|l|l||l|l|} \hline
  {\it Command} & {\it Section}     & {\it Command} & {\it Section}     \\ \hline
  alias         & \sref{s:alias}    & re_execute    & \sref{s:re.exe}   \\ \hline
  call          & \sref{s:call}     & read          & \sref{s:read}     \\ \hline
  change        & \sref{s:change}   & restore       & \sref{s:restore}  \\ \hline 
  clip          & \sref{s:clip}     & reinitialize  & \sref{s:reinit}   \\ \hline 
  continue      & \sref{s:continue} & run_optimizer & \sref{s:run}      \\ \hline 
  derivative    & \sref{s:deriv}    & scale         & \sref{s:scale}    \\ \hline 
  do, enddo     & \sref{s:do}       & set           & \sref{s:set}      \\ \hline  
  end_file      & \sref{s:end.file} & show          & \sref{s:show}     \\ \hline 
  exit          & \sref{s:exit}     & single_mode   & \sref{s:sing}     \\ \hline 
  flatten       & \sref{s:flatten}  & spawn         & \sref{s:spawn}    \\ \hline 
  help          & \sref{s:help}     & timer         & \sref{s:timer}    \\ \hline
  misalign      & \sref{s:misalign} & use           & \sref{s:use}      \\ \hline 
  pause         & \sref{s:pause}    & veto          & \sref{s:veto}     \\ \hline 
  place         & \sref{s:place}    & value         & \sref{s:value}    \\ \hline
  plot          & \sref{s:plot}     & wave          & \sref{s:wave}     \\ \hline
  ptc           & \sref{s:ptc}      & write         & \sref{s:write}    \\ \hline 
  python        & \sref{s:python}   & x_axis        & \sref{s:x.axis}   \\ \hline 
  quiet         & \sref{s:quiet}    & x_scale       & \sref{s:x.scale}  \\ \hline 
  quit          & \sref{s:quit}     & xy_scale      & \sref{s:xy.scale} \\ \hline
\end{tabular}}
\caption{Table of \tao commands.}
\label{t:commands}
\end{table}

%% Marker: "help" will not display anything after this  -----------

\vfil
\break

%% alias --------------------------------------------------------------
\section{alias}\index{commands!alias}
\label{s:alias}

The \vn{alias} command defines command shortcuts. Format:
\begin{example}
  alias \{<alias_name> <string>\}
\end{example}

\vskip 0.1in

\vn{Alias} is like Unix aliases. Using the \vn{alias} command without any arguments
results in a printout of the aliases that have been defined. When using an alias up to 9
arguments may be substituted in the \vn{<string>}. The i\Th argument is substituted in
place of the sub-string ``[[i]]''.  arguments that do not have a corresponding ``[[i]]''
are placed at the end of \vn{<string>}.

Aliases can be set up for multiple commands using semicolons.

Examples:
\begin{example}
    alias xyzzy plot [[1]] model  ! Define xyzzy
    alias                         ! Show all aliases
    xyzzy top                     ! Use an alias
    plot top model                ! Equivalent to "xyzzy top"
    xyzzy top abc                 ! Equivalent to "plot top model abc"
    alias foo  show uni; show top ! "foo" equivalent to "show uni; show top"
\end{example}
In the above example ``xyzzy'' is the alias for the string ``plot [[1]] model''.  When the
command xyzzy is used ``top'' is substituted for ``[[1]]'' in the string.

%% call --------------------------------------------------------------
\section{call}\index{commands!call}
\label{s:call}

The \vn{call} command opens a command file (\sref{s:command.files}) and executes the
commands in it.  Format:
\begin{example}
  call <filename> \{<arg_list>\}  \Strut
  call -ptc <filename>
\end{example}

\vskip 0.2in 
\tao first looks in the current directory for the command file.

The \vn{call} command without \vn{-ptc} is for running a set of \tao commands.  Up to 9
arguments may be passed to the command file. The i\Th argument is substituted in place of
the string ``[[i]]'' in the file. Nesting of command files (command files calling other
command files) is allowed. There is no limit to the number of nested files.  See
Section~\sref{s:command.files} for more details.

The \vn{call -ptc} command passes the command file to PTC for processing. Previous to such
a call, the command \vn{ptc init} must be issued.

If the command file has the \vn{quiet} command in it, output to the terminal is surpresed (but
only for the duration of the execution of the file).

Command loops can be implemented in a command file. See Section~\sref{s:do} for more details.

Other useful commands to put in a command file are to speed up execution are:
\begin{example}
  set global lattice_calc_on = F   ! Stop lattic calculations
  set global plot_on = F           ! Halt replotting
\end{example}
If set, at the end of the command file these logicals should be toggled back to True.

Examples:
\begin{example}
    call my_cmd_file abc def 
\end{example}
In the above example the argument ``abc'' is substituted for any ``[[1]]'' appearing the
file and ``def'' is substituted for any ``[[2]]''.  \Newline

%% change --------------------------------------------------------------
\section{change}\index{commands!change}
\label{s:change}

The \vn{change} command changes element attribute values or variable values in the
\vn{model} lattice. Format:
\begin{example}
  change element <element_list> <attribute> \{prefix>\} <number>
  change \{-silent\} variable <name>[<locations>] \{<prefix>\} <number>
  change  \{n@\}beam_start <coordinate> \{prefix>\} <number>
\end{example}

\vskip 0.2in 

The \vn{change} is used for changing real (as opposed to integer or logical)
parameters. Also see the \vn{set} command (\sref{s:set}) which is more general.

If \vn{<prefix>} is not present, \vn{<number>} is added to the existing value
of the attribute or variable. That is:
\begin{example}
  final_model_value = initial_model_value + <number>
\end{example}
If \vn{<prefix>} is present, it may be one of
\begin{example}
  @       final_model_value = <number>
  d       final_model_value = design_value + <number>
  \%       final_model_value = initial_model_value * (1 + <number> / 100)
\end{example}

Element list format (\sref{s:ele.list.format}), without any embedded blanks, is used for
the \vn{<element_list>} argument.

For \vn{change beam_start}, The optional \vn{n@} universe specification
(\sref{s:universe}) may be used to specify the universe or universes to apply the change
command to.

For lattices with an open geometry, \vn{change beam_start <coordinate> <number>} can be
used to vary the starting coordinates for single particle tracking or the centroid
coordinates for beam tracking. Here \vn{<coordinate>} is one of:
\begin{example}
  x, px, y, py, z, pz, t
\end{example}
For photons, \vn{<coordinate>} may also be:
\begin{example}
  field_x, field_y, phase_x, phase_y
\end{example}
For closed lattices only the \vn{pz} component is applicable. For lattices that have an
\vn{e_gun} (which necessarily implies that the lattice has an open geometry), the time
\vn{t} coordinate must be varied instead of \vn{pz}.

For open lattices, \vn{change element beginning <twiss>} can be used to vary the starting
Twiss parameters where \vn{<twiss>} is one of:
\begin{example}
  beta_a, beta_b, alpha_a, alpha_b 
  eta_a, eta_b,etap_a, etap_b    
\end{example}

The \vn{-silent} switch, if present, suppresses the printing of what variables are
changed.

Examples:
\begin{example}
  change ele 3@124 x_offset 0.1        ! Offset element #124 in universe 3 by 0.1
  change ele 1,3:5 x_offset 0.1        ! Offset elements 1, 3, 4, and 5 by 0.1
  change ele q* k1 d 1.2e-2            ! Set the k1 strength of all elements starting with
                                       !   the letter "q" relative to the design
  change ele quadrupole::* k1 d 1.2e-2 ! Set the k1 strength of all quadrupole elements.
  change var steering[34:36] @1e-3     ! set the steering strength #34-36 to 0.001
  change var steering[*] \%10           ! vary all steering strengths by 10\%
  change 2@beam_start x @0.001         ! set beginning x position in universe 2 to 1 mm.
\end{example}


%% clip --------------------------------------------------------------
\section{clip}\index{commands!clip}
\label{s:clip}

The \vn{clip} command vetoes data points for plotting and optimizing. That is, the
\vn{good_user} logical of the data associated with the out-of-bound plotted points are set
to False.  Format:
\begin{example}
  clip \{-gang\} \{<where> \{<limit1> \{<limit2>\}\}\}
\end{example}

\vskip 0.2in 

Which graphs are clipped is determined by the \vn{<where>} switch. If \vn{<where>} is not
present, all graphs are clipped. If \vn{where} is a plot name, then all the graphs of that
plot are clipped. If \vn{where} is the name of a \vn{d2_data} (for example, \vn{orbit}) or
a \vn{d1_data} (for example, \vn{orbit.x}) structure, then those graphs that display this
data are clipped.

The points that are clipped those points whose $y$ values are outside a certain range
defined by \vn{<limit1>} and \vn{<limit2>}. If neither \vn{<limit1>} nor \vn{<limit2>} are
present, the clip range is taken to be outside the graph minimum and maximum $y$--axis
values. If only \vn{<limit1>} is present then the clip range is outside the region from
-\vn{<limit1>} to +\vn{<limit1>}. If both are present than the range is from \vn{<limit1>}
to \vn{<limit2>}.

The \vn{-gang} switch is apply a clip to corresponding data in a \vn{d2_data} structure.
For example
\begin{example}
  clip -g orbit.x   ! Clips both orbit.x and orbit.y 
\end{example}
Here the \vn{orbit.x} data is clipped and the corresponding data in \vn{orbit.y} is also
vetoed. For example, if datum number 23 in \vn{orbit.x} is clipped, datum number 23 in
\vn{orbit.y} will be vetoed.

Examples:
\begin{example}
  clip top.x -3  7  ! Clip the curves in the x graph in the top region
  clip bottom       ! Clip the graphs in the bottom region
  clip -g orbit.x   ! Clip the 
\end{example}

%% continue --------------------------------------------------------------
\section{continue}\index{commands!continue}
\label{s:continue}

The \vn{continue} command is used to continue reading of a suspended command file
(\sref{s:command.files}) after a \vn{pause} command (\vn{s:pause}). Format:
\begin{example}
  continue
\end{example}

%% do --------------------------------------------------------------
\section{do, enddo}\index{commands!do}
\label{s:do}

Command loops can be implemented in a command file files. Format:
\begin{example}
  do <var> = <l_bound>, <u_bound> \{<incr>\}
    ...   ! use the syntax ``[[<var>]]'' to refer to a variable.
  enddo
\end{example}
Note: ``\vn{enddo}'' is one word and my not be split into two words.
Loops can be nested and the number of levels is not unlimited. 

A loop will execute the code in between the \vn{do} and \vn{enddo} lines a certain number of
times. Each time trough the the the integer variable \vn{<var>} will be increamented by \vn{<incr>},
starting at \vn{<l_bound>} and stopping before \vn{<var>} is greater than \vn{<u_bound>}. If
\vn{<incr>} is not present, the increment will be 1. Note: \vn{<l_bound>}, \vn{<u_bound>}, and
\vn{<incr>} must all be integers.

Example:
\begin{example}
  do j = 0, 10, 2
    set beam_start pz = 1e-3 * [[j]]
    ...
  enddo
\end{example}
As shown in the above example, to refer to a loop variable in a command, use the syntax ``[[<var>]]''.

%% end_file --------------------------------------------------------------
\section{end_file} \label{s:end.file}
\index{commands!end_file}

The \vn{end_file} command is used in command files (\sref{s:command.files}) to signal the
end of the file. Everything after an \vn{end_file} command is ignored. An \vn{end_file}
command entered at the command line will simply generate an error message.  Format:
\begin{example}
  end_file
\end{example}

%% exit --------------------------------------------------------------
\section{exit}\index{commands!exit}
\label{s:exit}

The \vn{exit} command exits the program. Same as \vn{Quit}.  Format:
\begin{example}
  exit
\end{example}

%% derivative --------------------------------------------------------------
\section{derivative}\index{commands!derivative}
\label{s:deriv}

The \vn{derivative} command calculates the \vn{dModel_Data/dVar} derivative matrix needed
for the \vn{lm} optimizer.  Format:
\begin{example}
  derivative
\end{example}

%% flatten --------------------------------------------------------------
\section{flatten}\index{commands!flatten}
\label{s:flatten}

The \vn{Flatten} command runs the optimizer to minimize the merit function. This is the
same as the \vn{run_optimizer} command.  See the \vn{run_optimizer} command for more
details.  Format:
\begin{example}
  flatten \{<optimizer>\}
\end{example}

\vskip 0.2in

%% help --------------------------------------------------------------
\section{help}\index{commands!help}
\label{s:help}

The \vn{help} command gives help on \tao commands. Format:
\begin{example}
  help \{<command> \{<subcommand>\}\}
\end{example}

\vskip 0.2in

The \vn{help} command without any arguments gives a list of all commands.  Some commands,
like \vn{show}, are so large that help on these commands is divided up by their
subcommand.

Examples:
\begin{example}
  help            ! Gives list of commands.
  help run        ! Gives help on the run_optimizer command.
  help show       ! Help on the show command.
  help show alias ! Help on the show alias command.
\end{example}

Note: The \vn{help} command works by parsing the file \vn{\$TAO_DIR/doc/command-list.tex}
which is the LaTeX file for the Line Mode Commands chapter of the \tao manual. Thus, for
the \vn{help} command to work properly, the environmental variable \vn{TAO_DIR} must be
appropriately defined. Generally, \vn{TAO_DIR} will be defined if the appropriate setup
script has been run. For ``Distributions'', this is the same setup script used to setup a
distribution. See your local \bmad guru for details.

%% misalign --------------------------------------------------------------
\section{misalign}\index{command!misalign}
\label{s:misalign}

The \vn{misalign} command misaligns a set of lattice elements. Format:
\begin{example}
   misalign <wrt> <ele_type> <range> <ele_attrib> <misalign_value>
\end{example}

\vskip 0.2in 

\vn{<ele_type>} is the type of element to misalign.  Only elements of type \vn{<ele_type>}
will be misaligned within the range.  If \vn{<ele_type>} begins with "*@" then choose all
universes. If \vn{<ele_type>} begin with "n@" then choose universe n. Otherwise the
default universe (\sref{s:universe})) is used.

A lattice element will only be misaligned if its lattice index falls within a range given
by \vn{<range>}. \vn{<range>} is of the form \vn{nnn:mmm} or the word \vn{ALL}.

The element attribute \vn{<ele_attrib>} is ``misaligned'' by the rms value
\vn{<misalign_value>} with respect to the setting of \vn{<wrt>}. Any element attribute can
be misaligned provided the attribute is free to vary.

If \vn{<misalign_value>} is prepended by 'x' then the misalignment value will be a
relative misalignment with respect to the \vn{<wrt>} value. Otherwise, it's an absolute
rms value about the \vn{<wrt>} value.

In the special case where sbend strengths are misaligned then use \vn{<ele_attrib> =
g_err}. However, if a relative error is specified it will be relative to 'g'.

The possible values of \vn{<wrt>} are:
\begin{example}
  wrt_model          ! Misalign about the current model value
  wrt_design         ! Misalign about the design value
  wrt_survey         ! Misalign about the zero value
\end{example}

Examples
\begin{example}
   ! The following will misalign all quadrupole vertical positions in the default
   ! universe within the lattice element range 100:250 with respect to the zero 
   ! value by 300 microns
  misalign wrt_survey quadrupole 100:250 y_offset 300e-6
   ! The following will misalign all quadrupole strengths in all universes for
   ! the entire lattice with respect to the design value by 1%.
  misalign wrt_design *@quadrupole ALL k1 x0.01
\end{example}

%% pause --------------------------------------------------------------
\section{pause}\index{commands!pause}
\label{s:pause}

The \vn{pause} command is used to pause \tao when executing a command file
(\sref{s:command.files}). Format:
\begin{example}
  pause \{<time>\} ! Pause time in seconds.
\end{example}
\vskip 0.2in

If \vn{<time>} is not present or zero, \tao will pause until the \vn{CR} key is
pressed. Once the \vn{CR} key is pressed, the command file will be resumed. If \vn{<time>}
is negative, \tao will suspend the command file. Commands can now be issued from the
keyboard and the command file will be resumed when a \vn{continue} command
(\sref{s:continue}) is issued. Multiple command files can be simultaneously suspended.
Thus, while one command file is suspended, a second command file can be run and this
command file too can be suspended. A \vn{continue} command will resume the second command
file and when that command file ends, another \vn{continue} command will be needed to
complete the first suspended command file. Use the \vn{show global} command to see the
number of suspended command files.

Example:
\begin{example}
  pause 1.5    ! Pause for 1.5 seconds.
  pause -1     ! Suspend the command file until a \vn{continue} 
               !   command is issued.
\end{example}

%% place --------------------------------------------------------------
\section{place}\index{commands!place}
\label{s:place}

The \vn{place} command is used to associate a \vn{<template>} plot with a \vn{<region>}
and thus create a visible plot in that region. Format:
\begin{example}
  place <region> <template>
  place <region> none
  place * none
\end{example}

\vskip 0.2in 

To erase a plot from a region use \vn{none} in place of a template name. Notice that by
using multiple \vn{place} commands a \vn{template} can be associated with more than one
region.  \vn{place * none} will erase all plots.

Examples:
\begin{example}
  place top orbit  ! place the orbit template in the top region
  place top none   ! erase any plots in the top region
\end{example}

%% plot --------------------------------------------------------------
\section{plot}\index{commands!plot}
\label{s:plot}

The \vn{plot} command is used to determine what ``components'' (\sref{s:plot.data}) are
plotted in the specified graphs or plots. Format:
\begin{example}
  plot <plot_or_graph> <component>
\end{example}

\vskip 0.2in 

components are a property of a graph (or curve) so when <plot_or_graph> specifies a plot,
all the graphs associated with the plot are assigned the \vn{<component>}.

Note: The plot command is a shortcut for the commands:
\begin{example}
  set plot <plot_name> component = <component>     ! and
  set graph <graph_name> component = <component>
\end{example}
Also see the \vn{set curve} command.

Use a ``-'' for baselines. 

Examples:
\begin{example}
  plot bottom.g1 model - design        ! Plot model - design in the g1 graph of the bottom region
  plot top meas - model + design - ref ! Set the components for the graphs in the top region.
\end{example}

%% ptc -----------------------------------------------------------
\section{ptc}\index{commands!ptc}
\label{s:ptc}

The \vn{ptc} command is used manipulating PTC layouts associated with Bmad
lattices. Format:
\begin{example}
  ptc init            ! Init associated PTC layout.
\end{example}

\vskip 0.2in 

The \vn{ptc init} command must be run before running any other \vn{ptc} command is used.

Also see:
\begin{example}
  call -ptc <file>         ! Run a PTC script
  read ptc                 ! Read a PTC lattice
  write ptc                ! Write a PTC lattice
\end{example}

Examples:
\begin{example}
  ptc init
\end{example}

%% python -----------------------------------------------------------
\section{python}\index{commands!python}
\label{s:python}

The \vn{python} command is like the \vn{show} command in that the \vn{python} command
prints information to the terminal. The difference is that the output from the \vn{show}
command is meant for viewing by the user while the output of the \vn{python} command is
meant for easy parsing. Format:
\begin{example}
  python \{-append <file_name>\} \{-noprint\} <what_to_print>
  python \{-write <file_name>\} \{-noprint\} <what_to_print>
\end{example}

The \vn{python} command has \vn{-append} and \vn{-write} optional arguments which can be
used to write the results to a file. The \vn{python -append} command will appended to the
output file. The \vn{python -write} command will first erase the contents of the output
file. Example:
\begin{example}
  python -write d2.dat data_d2    ! Write to file "d2.dat"
\end{example}

The \vn{-noprint} option suppresses printing and is useful when writing large amounts of
data to a file.  The \vn{python} command can be used to pass information to a parent
process when \tao is run as a subprocess.  The parent process may be any scripting program
like Python, Perl, Tcl, etc.  In particular, see \sref{c:python} for details on how to run
\tao as a Python subprocess.

For long term maintainability of python scripts, the advantage of using the \vn{python}
command in the scripts over the \vn{show} command comes from the fact that the output
syntax of the \vn{show} command can (and does) change.

For further documentation on the python command, please look at the file tao/code/tao_python.f90.

Note: At this point in time, the \vn{python} command is still in development.  Please
contact David Sagan if needed.

%% quiet --------------------------------------------------------------
\section{quiet}\index{commands!quiet}
\label{s:quiet}

Format:
\begin{example}
  quiet
\end{example}

The \vn{quiet} command can only be used in command files (\sref{s:call}).
When placed in a command file, output to the terminal is surpresed (but
only from the \vn{quiet} command for the duration of the execution of the file).

Other useful commands to put in a command file are to speed up execution are:
\begin{example}
  set global lattice_calc_on = F   ! Stop lattic calculations
  set global plot_on = F           ! Halt replotting
\end{example}
If set, at the end of the command file these logicals should be toggled back to True.

%% quit --------------------------------------------------------------
\section{quit}\index{commands!quit}
\label{s:quit}

\vn{Quit} exits the program. Same as \vn{exit}.
Format:
\begin{example}
  quit
\end{example}

%% re_execute --------------------------------------------------------------
\section{re_execute}
\index{commands!re_execute}
\label{s:re.exe}

The \vn{re_execute} command reruns prior commands.  Format:
\begin{example}
  re_execute <index>   ! Re-execute a command with the given index number.
  re_execute <string>  ! Re-execute last command that begins with <string>.
\end{example}

\vskip 0.2in 
Every \tao command entered is recorded in a ``history stack''. These
commands can be viewed using the \vn{show history} command. The \vn{show_history}
command will also display the index number associated with each command.

Examples
\begin{example}
  re_exe 34   ! Re-execute command number 34.
  re_exe set  ! Re-execute last ``set'' command.  
\end{example}

%% read --------------------------------------------------------------
\section{read}\index{commands!read}
\label{s:read}

The \vn{read} command is used to modify the (\bmad) \vn{model} lattice or the associated
\vn{PTC} lattice.  Format:
\begin{example}
  read lattice <file_name>
  read ptc \{-old\} <file_name>
\end{example}

\vskip 0.2in 

With the \vn{read lattice} command, the \vn{model} lattice contained in the default
universe (\sref{s:universe}) is modified using a ``secondary'' lattice file.  [See the
\bmad manual for the definition of secondary.]

For example, with the appropriate file, the \vn{read} command can be used to misalign the
lattice elements. The input file must be in Bmad standard lattice format.

Note: Due to bookkeeping complications, the number of lattice elements may not be
modified. If it is desired to initiate \tao using both ``primary'' and secondary lattice
files, this can be done as illustrated in \sref{s:init.lat}.

The \vn{read ptc} command reads in a PTC lattice. WARNING: This command is
untested. Please contact David Sagan if you want to use it.

%% restore --------------------------------------------------------------
\section{restore}\index{commands!restore}
\label{s:restore}

The \vn{restore} command cancels data or variable
vetoes. Format:
\begin{example}
  restore data  <data_name> <locations>
  restore var <var_name> <locations>
\end{example}

\vskip 0.2in 

See also the \vn{use} and \vn{veto} commands.

Examples:
\begin{example}
  restore data orbit.x[23,34:56]   ! un-veto orbit.x 23 and 34 through 56.
  restore data orbit.x[23,34:56:2] ! un-veto orbit.x 23 and even data between 34 
                                   !                                          and 56
  restore data *@orbit[34]         ! un-veto orbit data in all universes.
  restore var quad_k1[67]          ! un-veto variable
\end{example}

%% reinitialize -------------------------------------------------------
\section{reinitialize}\index{commands!reinitialize}
\label{s:reinit}

The \vn{reinitialize} command reinitializes various things. Format:
\begin{example}
  reinitialize beam
  reinitialize data
  reinitialize tao \{command line optional arguments\}
\end{example}

\vskip 0.2in 

The \vn{reinitialize beam} command reinitializes the beam at the start of the
lattice. That is, a new random distribution is generated.  Note: This also reinitializes
the model data.

\vn{reinitialize data} forces a recalculation of the model data.  Normally, a
recalculation is done automatically when any lattice parameter is changed so this command
is generally only useful for debugging purposes.

\vn{reinitializes tao} reinitializes \tao. This can be useful to reset everything to
initial conditions or to perform analysis with more than one initialization file. See
section \sref{s:command.line} for a list of the optional arguments.  If an argument is not
set, the \vn{reinitialize} command uses the same argument value that were used in the last
\vn{reinitialize} command, or, if this is the first reinitialization, what was used to
start \tao.

Examples:
\begin{example}
  reinit tao                         ! Reinit using previous arguments
  reinit tao -init tao_special.init  ! Reinitializes \tao with the initialization file 
                                     !   tao_special.init
\end{example}


%% run --------------------------------------------------------------
\section{run_optimizer}\index{commands!run}
\label{s:run}

The \vn{run_optimizer} command runs an optimizer. Format:
\begin{example}
  run_optimizer \{<optimizer>\}
\end{example}

\vskip 0.2in 

\index{de!optimizer}\index{lm!optimizer}
If \vn{<optimizer>} is not given then the default optimizer is used. 
Use the \vn{show optimizer} (\sref{s:show.optimizer}) command to see optimizer parameters.
To stop the optimizer
before it is finished press the period ``.''  key. If you want the optimizer to run
forever run the optimizer in \vn{single mode}. Valid optimizers are:
\begin{example}
  de            ! Differential Evolution
  geodesic_lm   ! ``Geodesic'' Levenburg-Marquardt 
  lm            ! Levenburg-Marquardt from Numerical Recipes 
  lmdif         ! Levenburg-Marquardt 
\end{example}

See Chapter~\sref{c:opti} for details on how \tao structures optimization and 
for more details on the different optimizers.

Examples:
\begin{example}
  run         ! Run the default optimizer
  run de      ! Run the de optimizer
\end{example}

%% scale --------------------------------------------------------------
\section{scale}\index{commands!scale}
\label{s:scale}

The \vn{scale} command scales the vertical axis of a graph or set of graphs.  Format:
\begin{example}
  scale \{-y\} \{-y2\} \{-gang\} \{-nogang\} \{<where>\} \{<value1> \}<value2>\}\}\}
\end{example}

Which graphs are scaled is determined by the \vn{<where>} switch. If \vn{<where>} is not
present or \vn{<where>} is \vn{all} then all graphs are scaled. \vn{<where>} can be a plot
name or the name of an individual graph withing a plot.

\vskip 0.2in 

\vn{scale} adjusts the vertical scale of graphs. If neither \vn{<value1>} nor
\vn{<value2>} is present then an \vn{autoscale} is performed and the scale is adjusted so
that all the data points are within the graph region. If an autoscale is performed upon an
entire plot, and if \vn{plot%autoscale_gang_y} (\sref{s:template}) is True, then the
chosen scales will be the same for all graphs. That is, a single scale is calculated so
that all the data of all the graphs is within the plot region. The affect of
\vn{plot%autoscale_gang_y} can be overridden by using the \vn{-gang} or \vn{-nogang}
switches.

If only \vn{<value1>} is present then the scale is taken to be from -\vn{<value1>} to
+\vn{<value1>}. If both are present than the scale is from \vn{<value1>} to \vn{<value2>}.

A graph can have a \vn{y2} (left) axis scale that is separate from the \vn{y} (right)
axis. Normally, the \vn{scale} command will scale both axes.  Scaling of just one of these
axes can be achieved by using the \vn{-y} or \vn{-y2} switches.

Examples:
\begin{example}
  scale top.x -3  7  ! Scale the x graph in the top region
  scale -y2 top.x    ! Scale only the y2 axis of the top.x graph.
  scale bottom       ! Autoscale the graphs of the plot in the bottom region
  scale              ! Scale everything
\end{example}


%% set --------------------------------------------------------------
\section{set}\index{commands!set}
\label{s:set}


The \vn{set} command is used to set values for data,
variables, etc. Format:
\begin{example}
  set beam_init \{n@\}<component> = <value>                   ! \sref{s:set.beam.init}
  set beam_start \{n@\}<coordinate> = <value>                 ! \sref{s:set.beam.start}
  set bmad_com <component> = <value>                        ! \sref{s:set.bmad.com}
  set csr_param <component> = <value>                       ! \sref{s:set.csr.param}
  set curve <curve> <component> = <value>                   ! \sref{s:set.curve}
  set data <data_name>|<component> = <value>                ! \sref{s:set.data}
  set default <parameter> = <value>                         ! \sref{s:set.default}
  set element <element_list> <attribute> = <value>          ! \sref{s:set.element}
  set floor_plan <component> = <value>                      ! \sref{s:set.floor.plan}
  set geodesic_lm <component> = <value>                     ! \sref{s:set.geodesic.lm}
  set global <component> = <value>                          ! \sref{s:set.global}
  set graph <graph> <component> = <value>                   ! \sref{s:set.graph}
  set key <key> = <command>                                 ! \sref{s:set.key}
  set lat_layout <component> = <value>                      ! \sref{s:set.lat.layout}
  set lattice \{n@\}<destination\_lat> = <source\_lat>          ! \sref{s:set.lattice}
  set opti_de_param <component> = <value>                   ! \sref{s:set.opti.de.param}
  set plot <plot> <parameter> = <value>                     ! \sref{s:set.plot}
  set plot_page <parameter> = <value1> \{<value2>\}           ! \sref{s:set.plot.page}
  set ran_state = <random_number_generator_state>           ! \sref{s:set.ran.state}
  set universe <what_universe> <on/off>                     ! \sref{s:set.universe}
  set universe <what_universe> recalculate                  ! \sref{s:set.universe}
  set universe <what_universe> mat6_recalc <on/off>         ! \sref{s:set.universe}
  set universe <what_universe> track_recalc <on/off>        ! \sref{s:set.universe}
  set variable <var_name>|<component> = <value>             ! \sref{s:set.variable}
  set wave <component> = <value>                            ! \sref{s:set.wave}
\end{example}

\vskip 0.2in 

Also see the \vn{change} command (\sref{s:change}). The \vn{change} command is specialized
for varying real parameters while the \vn{set} command is more general.

Note: The \vn{show} command (\sref{s:show}) is able to display the settings of many variables
that can be set by the \vn{set} command.

To apply a set to all data or variable classes use ``*'' in place of \vn{<data_name>} or
\vn{var_name}.

To set the prompt color, use the command
\begin{example}
  set global prompt_color = <value>
\end{example}
Where \vn{<value>} may be one of:
\begin{example}
  'BLACK'
  'RED'
  'GREEN'
  'YELLOW'
  'BLUE'
  'MAGENTA'
  'CYAN'
  'GRAY'
  'DEFAULT'       ! Default foreground color
\end{example}

% Use the command:
%   help set <what>
% to obtain more information on a particular set subtopic. Example:
%   help set plot

%% set beam_init --------------------------------------------------------------

\subsection{set beam_init}
\label{s:set.beam.init}

Format:
\begin{example}
  set beam_init \{n@\}<component> = <value>
\end{example}

For \vn{set beam_init}, the \vn{<component>}s that can be set can be found in
section~\sref{s:beam.init}. The optional \vn{n@} allows the specification of the universe
or universes the set is applied to. The current default universe (\sref{s:universe}) will
be used if no universe is given. Use the \vn{show beam} command (\sref{s:show}) to see the
current values of the \vn{beam_init} structure.

Examples:
\begin{example}
  set beam_init 3@center(2) = 0.004  ! Set px center of beam for universe 3.
  set beam_init [1,2]@sig_e = 0.02   ! Set sig_e for universes 1 and 2.
\end{example}

%% set beam_start --------------------------------------------------------------

\subsection{set beam_start}
\label{s:set.beam.start}

Format:
\begin{example}
  set beam_start \{n@\}<coordinate> = <value>
\end{example}

The optional \vn{n@} universe specification (\sref{s:universe}) may be used to specify the universe
or universes to apply the set command to.

For lattices with an open geometry, \vn{set beam_start <coordinate> <number>} can be used to vary
the starting coordinates for single particle tracking or the centroid coordinates for beam
tracking. Here \vn{<coordinate>} is one of:
\begin{example}
  x, px, y, py, z, pz, t
\end{example}
For photons, \vn{<coordinate>} may also be:
\begin{example}
  field_x, field_y, phase_x, phase_y
\end{example}
For closed lattices only the \vn{pz} component is applicable. For lattices that have an
\vn{e_gun} (which necessarily implies that the lattice has an open geometry), the time
\vn{t} coordinate must be varied instead of \vn{pz}.

To see the values for \vn{beam_start} use the command \vn{show element 0}.

Examples:
\begin{example}
  set beam_start 2@x = 0.001         ! set beginning x position in universe 2 to 1 mm.
\end{example}

%% set bmad_com --------------------------------------------------------------

\subsection{set bmad_com}
\label{s:set.bmad.com}

Format:
\begin{example}
  set bmad_com <component> = <value>
\end{example}


For \vn{set bmad_com}: The \vn{show global} command will give a list of 
\vn{<component>}s.

Example:
\begin{example}
  set bmad_com radiation_fluctuations_on = T ! Turn on synchrotron radiation fluctuations.
\end{example}

%% set csr_param --------------------------------------------------------------

\subsection{set csr_param}
\label{s:set.csr.param}

Format:
\begin{example}
  set csr_param <component> = <value>
\end{example}


Sets coherent synchrotron radiation parameters. Use the \vn{show global -csr_param}
command to see a list of \vn{<component>}s.

Example:
\begin{example}
  set csr_param n_bin = 30  ! Set number of bins used in the csr calc.
\end{example}

%% set curve --------------------------------------------------------------

\subsection{set curve}
\label{s:set.curve}

Format:
\begin{example}
  set curve <curve> <component> = <value>
\end{example}


For \vn{set curve}, the \vn{<component>}s that can be set are:
\begin{example}
  ele_ref_name        = <string>  ! Name of reference element
  component           = <string>  ! \sref{s:plot.data}
  ix_branch           = <number>  ! Branch index.
  ix_bunch            = <number>  ! Bunch index.
  ix_ele_ref          = <number>  ! Index of reference element
  ix_universe         = <number>  ! Universe index.
  symbol_every        = <number>  ! Symbol skip number.
  y_axis_scale_factor = <number>  ! Scaling of y axis
  draw_line           = <logical> 
  draw_symbols        = <logical> 
  draw_symbol_index   = <logical> 
\end{example}
See Section~\sref{s:template} for a description of these attributes.  Use the \vn{show
curve} (\sref{s:show}) to see the settings of the attributes.

Examples:
\begin{example}
  set curve top.x.c1 ix_universe = 2  ! Set universe number for curve
\end{example}

%% set data --------------------------------------------------------------

\subsection{set data}
\label{s:set.data}

Format:
\begin{example}
  set data <data_name>|<component> = <value>
\end{example}


For \vn{set data}, the \vn{<component>}s that can be set are:
\begin{example}
  base        ! Base model value
  design      ! Design model value
  meas        ! Measured data value.
  ref         ! Reference data value.
  weight      ! Weight for the merit function.
  exists      ! Valid datum for computations?
  good_meas   ! A valid measurement has been taken?
  good_ref    ! A valid reference measurement has been taken?
  good_opt    ! Good for using in the merit function for optimization?
  good_plot   ! Good for using in a plot?
  good_user   ! This is what is set by the use, veto, and restore commands.
  merit_type  ! How merit contribution is calculated.
\end{example}
Besides a numeric value \vn{<value>} can be any of the above along with:
\begin{example}
  meas        ! Measured data value.
\end{example}

Examples:
\begin{example}
  set data *|ref = *|meas            ! Set ref data = measured in current universe.
  set data 2@orbit.x|base = 2@orbit.x|model 
                                     ! Set the base orbit.x in universe 2 to model
  set data beta.x[10]|weight = 1e-5  ! Set weight of datum.
\end{example}

%% set default --------------------------------------------------------------

\subsection{set default}
\label{s:set.default}

Format:
\begin{example}
  set default <parameter> = <value>
\end{example}

The parameters that can be set are:
\begin{example}
  branch            ! See: \sref{s:lattice}
  universe          ! See: \sref{s:universe}
\end{example}

Use the \vn{show global} (\sref{s:show}) command to see the current
default values.

Example:
\begin{example}
  set default universe = 3
\end{example}

%% set element --------------------------------------------------------------

\subsection{set element}
\label{s:set.element}

Format:
\begin{example}
  set element <element_list> <attribute> = <value>
\end{example}

The \vn{set element} command sets the attributes of an element. Use the \vn{show element}
command to view the attributes of an element.

Note: If an element in the \vn{<element_list>} does not sepcify a universe or universes,
only the element in the viewed universe is used. See the examples below.

Note: It is also possible to use the \vn{change element} command to change
real (as opposed to logical or integer) attributes.

Examples:
\begin{example}
  set ele rfcav::* is_on = F        ! Turn off all rfcavity elements the viewed universe.
  set ele *@rfcav::* is_on = F      ! Turn off all rfcavity elements in all universes.
  set ele A:B track_method = linear ! Set tracking_method for all elements between 
                                    !   elements A and B
  set ele q10w k1 = 0.7             ! Set element q10w k1 of the viewed universe.
\end{example}

%% set floor_plan --------------------------------------------------------------

\subsection{set floor_plan}
\label{s:set.floor.plan}

Format:
\begin{example}
  set floor_plan <component> = <value>
\end{example}


Sets parameters for \vn{floor_plan} plots (\sref{s:layout.and.floor}).  Possible
\vn{<components>} are:
\begin{example}
  <shape_name>%<shape_component>
  draw_beam_chamber_wall
  beam_chamber_wall_scale
\end{example}
Where \vn{<ele_shape_name>} is of the form ``\vn{shape<n>}'' where \vn{<n>} is the index
of the \vn{ele_shape} in the \vn{floor_plan_drawing} namelist.  Use ``\vn{show plot
-floor_plan}'' to see the current state of the \vn{floor_plan} parameters

Example:
\begin{example}
  set floor_plan shape2%draw = F  ! Veto drawing of ele_shape(2)
  set floor_plan beam_chamber_scale = 0.5
\end{example}

%% set geodesic_lm --------------------------------------------------------------

\subsection{set geodesic_lm}
\label{s:set.geodesic.lm}

Format:
\begin{example}
  set geodesic_lm <component> = <value>
\end{example}

For \vn{set geodesic_lm}: The \vn{show optimizer geodesic_lm} command will give a list of
\vn{<component>}s.

Example:
\begin{example}
  set geodesic_lm imethod = 10
\end{example}

%% set global --------------------------------------------------------------

\subsection{set global}
\label{s:set.global}

Format:
\begin{example}
  set global <component> = <value>
\end{example}

For \vn{set global}: The \vn{show global} command will give a list of \vn{<component>}s.

Example:
\begin{example}
  set global n_opti_loops = 30  ! Set number of optimization cycles
  set global rf_on = T          ! Turn on the RF cavities.
\end{example}

%% set graph --------------------------------------------------------------

\subsection{set graph}
\label{s:set.graph}

Format:
\begin{example}
  set graph <graph> <component> = <value>
\end{example}

For \vn{set graph}, the \vn{component}s that can be set are:
\begin{example}
  component   = <string>     ! \sref{s:plot.data}
  clip        = <logical>
  ix_universe = <number>
  margin      = <qp_rect_struct>
  x           = <qp_axis_struct>
  y           = <qp_axis_struct>
  y2          = <qp_axis_struct>
\end{example}

For setting the \vn{component} attribute see also the commands:
\begin{example}
  plot                    ! \sref{s:plot}
  set plot component      ! \sref{s:set.plot}
  set curve component     ! \sref{s:set.curve}
\end{example}

Example:
\begin{example}
  set graph orbit.x component = model - design  
                          ! Plot model orbit - design orbit in the graph
\end{example}


%% set key --------------------------------------------------------------

\subsection{set key}
\label{s:set.key}

Format:
\begin{example}
  set key <key> = <command>
\end{example}

Binds a custom command to a key for use in single mode (\sref{c:single}).  This will
override the default behavior (if there is one) of the key.  The command \vn{default} will
reset the key to its default usage.

Example:
\begin{example}
  set key h = veto var *
  set key j = default
\end{example}


%% set lat_layout --------------------------------------------------------------

\subsection{set lat_layout}
\label{s:set.lat.layout}

Format:
\begin{example}
  set lat_layout <component> = <value>
\end{example}

Sets parameters for \vn{lat_layout} plots (\sref{s:layout.and.floor}).  Syntax for
``\vn{set lat_layout}'' is identical to syntax of ``\vn{set floor_plan}''.  See ``\vn{set
floor_plan}'' for more details.

Use ``\vn{show plot -lat_layout}'' to see a listing of all shapes. 

Example:
\begin{example}
  set lat_layout shape2%draw = F  ! Veto drawing of shape \#2
\end{example}

%% set lattice --------------------------------------------------------------

\subsection{set lattice}
\label{s:set.lattice}

Format:
\begin{example}
  set lattice \{n@\}<destination_lat> = <source_lat>
\end{example}

The \vn{set lattice} command transfers lattice parameters (element strengths, etc., etc.)
from one lattice (the \vn{source} lattice) to another (the \vn{destination} lattice). Both
lattices are restricted to be from the same universe. The optional \vn{n@} prefix
(\sref{s:universe}) of the destination lattice can be used to specify which universe the
lattices are in. If multiple universes are specified, the corresponding destination
lattice will be set to the corresponding source lattice in each universe. Note: At this
time, it is not permitted to transfer parameters between lattices in different universes.

The destination lattices that can be set are:
\begin{example}
  model      ! Model lattice.
  base       ! Base lattice
\end{example}
The source lattice can be:
\begin{example}
  model       ! model lattice.
  base        ! base lattice.
  design      ! design lattice
\end{example}

Note: \tao variables that control parameters in multiple universes can complicate
things. If, for example, there are two universes, and a \tao variable controls, say, the
quadrupole strength of quadrupoles in both universes, then a ``set lat 2@model = design''
will result in the quadrupole strengths of those quadrupoles controlled by the variable in
universe 1 being changed.

Example:
\begin{example}
  set lattice *@model = design  ! Set the model lattice to the design in 
                                !   all universes.
  set lattice base = model      ! Set the base lattice to the model lattice in 
                                !   the default universe.
\end{example}

%% set opti_de_param --------------------------------------------------------------

\subsection{set opti_de_param}
\label{s:set.opti.de.param}

Format:
\begin{example}
  set opti_de_param <component> = <value>
\end{example}

For \vn{set opti_de_param}: The \vn{show global} command will give a list of 
\vn{<component>}s.

Example:
\begin{example}
  set opti_de_param binomial_cross = T  ! Use binomial crossovers 
\end{example}

%% set plot --------------------------------------------------------------

\subsection{set plot}
\label{s:set.plot}

Format:
\begin{example}
  set plot <plot_or_region> <parameter> = <value>
\end{example}

For \vn{set plot}, \vn{<component>}s that can be set are:
\begin{example}
  autoscale_x = <logical>
  autoscale_y = <logical>
  visible     = <logical>
  component   = <string>    ! \sref{s:plot.data}
\end{example}

The \vn{visible} parameter hides a plot but keeps the plot associated with the associate region. If
the plot window is not enabled (\vn{-noplot} option used at startup), the \vn{visible} parameter is
used by \tao to decide whether to calculate the points needed for plotting curves (saves time if the
computation is not needed). This is relavent when \tao is interfaced to a \vn{gui}
(\sref{s:gui.plot}).

Note: If the \vn{component} parameter is set, the \vn{<value>} is stored in each of the graphs of
the plot since the \vn{component} attribute is associated with individual graphs and not the plot as
a whole. Other commands that involve \vn{component} are:
\begin{example}
  plot                    ! \sref{s:plot}
  set graph component     ! \sref{s:set.graph}
  set curve component     ! \sref{s:set.curve}
\end{example}

Example:
\begin{example}
  set plot orbit visible = F        ! Hide orbit plot
  set plot beta component = design  ! 
\end{example}

%% set plot_page --------------------------------------------------------------

\subsection{set plot\_page}
\label{s:set.plot.page}

Format:
\begin{example}
  set plot_page <component> = <value1> \{<value2>\}
\end{example}

For \vn{set plot_page}, the \vn{<component>}s that can be set are:
\begin{example}
  title        = <string>          ! Set the plot title text
  subtitle     = <string>          ! Set the subtitle text
  subtitle_loc = <number> <number> ! Set the subtitle location (\%PAGE)
\end{example}
The \vn{subtitle_loc} component can be used to place the subtitle anywhere on the plot
page. This can be useful for referencing a noteworthy part of a graph data.

Example:
\begin{example}
  set plot_page title = 'XYZ'  ! Set plot page title string
\end{example}

%% set ran_state --------------------------------------------------------------

\subsection{set ran\_state}
\label{s:set.ran.state}

Format:
\begin{example}
  set ran_state = <random_number_generator_state>
\end{example}

Sets the state of the random number generator to a specific state. Use \vn{show global
-ran_state} to show the random number generator state.

%% set universe --------------------------------------------------------------

\subsection{set universe}
\label{s:set.universe}

Format:
\begin{example}
        set universe <what_universe> <on/off> 
        set universe <what_universe> recalculate
        set universe <what_universe> mat6_recalc <on/off>
        set universe <what_universe> dynamic_aperture_calc <on/off>
        set universe <what_universe> one_turn_map_calc <on/off>
        set universe <what_universe> track_recalc <on/off>
\end{example}

The \vn{set universe <what_universe> <on/off>} command will turn the specified universe(s)
on or off. Turning a universe off is useful to speed up lattice calculations when this
universe is not being used. Or, if many changes are to be performed to a universe and
there is no need to do any lattice calculations between commands then turning off all
universes will speed things up. To specify the currently default universe
(\sref{s:universe}), you can use \vn{-1} as an index. To specify all universes, use
\vn{*}.

If optimizing while one or more universes are turned off, the variables associated with
that universe will still be included in the merit function but not the data for that
universe. The variables will still vary in the turned off universe.

The \vn{set universe <what_universe> recalculate} command will recalculate the lattice
parameters for that universe.

The \vn{set universe <what_universe> dynamic_aperture_calc} command will enable the
dynamic aperture calculation for a ring. See \sref{s:dynamicaperture}. To enable the
dynamic aperture calculation at startup, set the \vn{design_lattice(i)%dynamic_aperture}
component (\sref{s:init.lat}).

The \vn{set universe <what_universe> one_turn_map_calc} command will enable a one-turn-map
calculation for a ring using PTC, and populate the normal form taylor maps. See
Eq.~\ref{normalform1} and Eq.~\ref{normalform2} in the \vn{normal.} data type. To enable
the map calculation at startup, set the \vn{design_lattice(i)%one_turn_map_calc} component
(\sref{s:init.lat}).

The commands
\begin{example}
  set universe <what_universe> mat6_recalc  and
  set universe <what_universe> track_recalc
\end{example}
will set whether the 6x6 transfer matrices and the central orbit (closed orbit for
circular rings) is calculated for a given universe. Turning this off is useful in speeding
up calculations in the case where the transfer matrices and/or orbit is not being used
(Warning: The transfer matrices are needed to compute the Twiss parameters). Use the
\vn{show universe} command to see the state of these switches are.

Example:
\begin{example}
  set universe 1 off
  set universe -1 on    ! Set on currently default universe.
  set universe * recalc ! Recalculate in all universes.
\end{example}

%% set variable --------------------------------------------------------------

\subsection{set variable}
\label{s:set.variable}

Format:
\begin{example}
  set variable <var_name>|<component> = <value>
\end{example}

For \vn{set var}, the \vn{<component>}s that can be set are:
\begin{example}
  model       ! Model lattice value.
  base        ! Base model value
  design      ! Design model value
  meas        ! Value at the time of a measurement.
  ref         ! Value at the time of a reference measurement.
  weight      ! Weight for the merit function.
  exists      ! Does this variable actually correspond to something?
  good_var    ! The optimizer can be allowed to vary it
  good_opt    ! Good for using in the merit function for optimization?
  good_plot   ! Good for using in a plot?
  good_user   ! This is what is set by the use, veto, and restore commands.
  step        ! Sets what a "small" variation of the variable is.
  merit_type  ! How merit contribution is calculated.
  key_bound   ! Model value can be modified using keyboard?
  key_delta   ! Change in model value when key is pressed.
\end{example}

Example:
\begin{example}
  set var quad_k1|weight = 0.1         ! Set quad_k1 weights. 
\end{example}

%% set wave --------------------------------------------------------------

\subsection{set wave}
\label{s:set.wave}

Format:
\begin{example}
  set wave <component> = <value>
\end{example}

The \vn{set wave} command sets the boundaries of the $A$ and $B$ regions for the wave
analysis (\sref{c:wave}). The components are
\begin{example}
  ix_a = <ix_a1> <ix_a2>  ! A-region left and right boundaries.
  ix_b = <ix_b1> <ix_b2>  ! B-region left and right boundaries.
\end{example}

Example:
\begin{example}
  set wave ix_a = 15 27    ! Set A-region to span from datum #15 to #27
\end{example}

Note: Use the \vn{wave} command (\sref{s:wave}) first to setup the display of the wave analysis.

%--------------------------------------------------------------------------
%% show --------------------------------------------------------------

\section{show}\index{commands!show}
\label{s:show}

The \vn{show} command is used to display information.
Format:
\begin{example}
  show \{-append <file_name>\} \{-noprint\} <what_to_show>
  show \{-write <file_name>\} \{-noprint\} <what_to_show>
\end{example}

\vn{<what_to_show>} may be one of:
\begin{example}
  show alias                                                          ! \sref{s:show.alias}
  show beam \{<element_name_or_index>\}                                 ! \sref{s:show.beam}
  show branch \{-universe <universe>\}                                  ! \sref{s:show.branch}
  show building_wall                                                  ! \sref{s:show.building}
  show constraints                                                    ! \sref{s:show.constraints}
  show curve \{-line\} \{-no_header\} \{-symbol\} <curve_name>              ! \sref{s:show.curve}
  show data \{<data_name>\}                                             ! \sref{s:show.data}
  show derivative <data_name(s)> <var_name(s)>                        ! \sref{s:show.derivative}
  show dynamic_aperture                                               ! \sref{s:show.dynamic}
  show element \{-attributes\} \{-base\} \{-data\} \{-design\} \{-all\} \{-field\} 
        \{-floor_coords\} \{-no_slaves\} \{-ptc\} \{-taylor\} \{-wall\} 
        \{-xfer_mat\} <ele_name>                                        ! \sref{s:show.element}
  show field <ele> <x> <y> <z> \{<t>\}                                    ! \sref{s:show.field}
  show global \{-bmad_com\} \{-csr_param\} \{-optimization\} \{-ran_state\}   ! \sref{s:show.global}
  show graph <graph_name>                                             ! \sref{s:show.graph}
  show history \{-no_num\} \{<num_to_display>\}                         ! \sref{s:show.history}
  show hom                                                            ! \sref{s:show.hom}
  show key_bindings                                                   ! \sref{s:show.key}
  show lattice \{-0undef\} \{-all\} \{-attribute <attrib>\} \{-base\} 
        \{-blank_replacement <string>\} \{-branch <name_or_index>\} 
        \{-custom <file_name>\} \{-design\} \{-floor_coords\} \{-lords\} \{-middle\} 
        \{-no_label_lines\} \{-no_tail_lines\} \{-no_slaves_lines\} \{-orbit\} 
        \{-radiation_integrals\} \{-remove_line_if_zero <column \#>\} \{-s <s1>:<s2>\} 
        \{-spin\} \{-tracking_elements\} \{<elements>\}                     ! \sref{s:show.lattice}
  show matrix \{-s\} \{loc1 \{loc2\}\}                                      ! \sref{s:show.matrix}
  show normal_form \{-order <n_order>\} <type>                        ! \sref{s:show.normal}
  show optimizer \{-geodesic_lm\}                                     ! \sref{s:show.optimizer}
  show particle \{-bunch <bunch_name_or_index>\} \{-particle <particle_index> 
        \{-element <element_name_or_index>\} \{-lost\} \{-all\}           ! \sref{s:show.particle}
  show plot \{-floor_plan\} \{-lat_layout \} \{<plot_region_name>\} 
        \{<template_plot_name>\}                                      ! \sref{s:show.plot}
  show taylor_map \{-order <n_order>\} \{-s\} \{loc1 \{loc2\}\}             ! \sref{s:show.taylor}
  show top10 \{-derivative\}                                          ! \sref{s:show.top10}
  show twiss_and_orbit \{-base\} \{-branch <name_or_index>\} \{-design\} 
        \{-universe <ix_uni>\} <s_position>                           ! \sref{s:show.twiss}
  show universe \{universe_number\}                                   ! \sref{s:show.universe}
  show use                                                          ! \sref{s:show.use}
  show value <expression>                                           ! \sref{s:show.value}
  show variable \{-no_label_lines\} \{-universe <universes>\}            
         \{-good_opt_only\} \{-bmad_format\} \{<var_name>\}                ! \sref{s:show.variable}
  show wakes                                                        ! \sref{s:show.wakes}
  show wall \{-branch <name_or_index>\} \{-section <index>\} \{-angle <angle>\} 
        \{-s <s1>:<s2>\} \{<n1>:<n2>\}                                  ! \sref{s:show.wall}
  show wave                                                         ! \sref{s:show.wave}
\end{example}

\vskip 0.2in 

The \vn{show} command has \vn{-append} and \vn{-write} optional arguments which can be
used to write the results to a file.  The \vn{show -append} command will appended to the
output file. The \vn{show -write} command will first erase the contents of the output
file. If \vn{global%write_file} has a \vn{*} character in it, a three digit number is
substituted for the \vn{*}. The value of the number starts at \vn{001} and increases by 1
each time \vn{show -write} is used.  Example:
\begin{example}
  show -write orb.dat orbit    ! Write orbit data to the file "orb.dat".
\end{example}

The \vn{-noprint} option suppresses printing and is useful when writing large amounts of
data to a file.

Note: When running \tao as a subprocess, consider using the \vn{python} command
(\sref{s:python}) instead of the \vn{show} command for communicating with the parent
process.

% Use the command:
%   help show <what>
% to obtain more information on a particular show subtopic. Example:
%   help show plot

%% show alias --------------------------------------------------------------

\subsection{show alias}
\label{s:show.alias}

Syntax:
\begin{example}
  show alias
\end{example}

Shows a list of defined aliases. See the \vn{alias} command for more details.

%% show beam --------------------------------------------------------------

\subsection{show beam}
\label{s:show.beam}

Syntax:
\begin{example}
  show beam \{<element_name_or_index>\}
\end{example}

If \vn{<element_name_or_index>} is absent, \vn{show beam} shows parameters used with beam
tracking including the number of particles in a bunch, etc.  If
\vn{<element_name_or_index>} is present, \vn{show beam} will show beam parameters at the
selected element. Also see \vn{show particle}.  Use the \vn{set beam_init} command to set
values of the \vn{beam_init} structure.

%% show branch --------------------------------------------------------------

\subsection{show branch}
\label{s:show.branch}

Syntax:
\begin{example}
  show branch \{-universe <universe>\}
\end{example}


Lists the lattice branches of the lattice associated with the given universe along with
information on the fork elements connecting the branches.  If no universe is given, the
current default universe (\sref{s:universe}) is used.

Example:
\begin{example}
  show branch -u 2     ! Show info on lattice branches associated with universe 2
\end{example}

%% show building_wall --------------------------------------------------------------

\subsection{show building_wall}
\label{s:show.building}

Syntax:
\begin{example}
  show building_wall
\end{example}
 

List all building wall (\sref{s:building.wall}) sections along with the points that define
the sections.

For vacuum_chamber, capillary, and diffraction_plate walls use the ``show wall'' command.

%% show constraints --------------------------------------------------------------

\subsection{show constraints}
\label{s:show.constraints}

Syntax:
\begin{example}
  show constraints
\end{example}


Lists data and variable constraints.

%% show curve --------------------------------------------------------------

\subsection{show curve}
\label{s:show.curve}

Syntax:
\begin{example}
  show curve \{-line\} \{-no_header\} \{-symbol\} <curve_name>
\end{example}


Show information on a particular curve of a particular plot. See \sref{c:plotting} for the
syntax on plot, graph, and curve names.  Use \vn{show plot} to get a list of plot
names. The \vn{-symbol} switch will additionally print the (x,y) points for the symbol
placement and the \vn{-line} switch will print the (x,y) points used to draw the
``smooth'' curve in between the symbols. The line or symbol points from multiple curves
can be printed by specifying multiple curves. Example:
\begin{example}
  show curve -sym orbit
\end{example}
This will produce a three column table assuming that the orbit plot has curves
\vn{orbit.x.c1} and \vn{orbit.y.c1}. When specifying multiple curves, each curve must have
the same number of data points and it will be assumed that the horizontal data values are
the same for all curves so the horizontal data values will be put in column 1.

The \vn{-no_header} switch is used with \vn{-line} and \vn{-symbol} to suppress the
printing of header lines. This is useful when the generated table is to be read in by
another program.

Also see: \vn{show plot} and \vn{show graph} commands.

Example:
\begin{example}
  show curve r2.g1.c3     ! Show the attributes of a curve named "c3" which is 
                          !   in the graph "g1" which is plotted in region "r2".
\end{example}

%% show data --------------------------------------------------------------

\subsection{show data}
\label{s:show.data}

Syntax:
\begin{example}
  show data \{<data_name>\}
\end{example}

Shows data information. If \vn{<data_name>} is not present then a list of all \vn{d2_data}
names is printed.

Examples:
\begin{example}
  show data                   ! Lists d2_data for all universes
  show data *@*               ! Same as above
  show data -1@*              ! Lists d2_data for the currently default universe.
  show data *                 ! Same as above.
  show data 2@*               ! Shows d2_data in universe 2.
  show data orbit             ! Show orbit data.
  show data orbit.x           ! list all orbit.x data elements.
  show data orbit.x[35]       ! Show details for orbit.x element 35
  show data orbit.x[35,86:95] ! list orbit.x elements 35 and 86 through 95
  show data orbit.x[1:99:5]   ! list every fifth orbit.x between 1 and 99  
\end{example}

%% show derivative --------------------------------------------------------------

\subsection{show derivative}
\label{s:show.derivative}

Syntax:
\begin{example}
  show derivative <data_name(s)> <var_name(s)>
\end{example}


\index{lm}\index{svd}
Shows the derivative dModel_Value/dVariable. This derivative is used by the optimizers
\vn{lm} and \vn{svd}. Note: Wild card characters can be used to show multiple derivatives.

Example:
\begin{example}
  show deriv orbit.x[23] k1[34] ! Show dModel_Value/dVariable Derivative.
  show deriv * *                ! Show all derivatives. Warning! The output 
                                ! may be large.
\end{example}

%% show dynamic_aperture --------------------------------------------------------------

\subsection{show dynamic_aperture}
\label{s:show.dynamic}

Syntax:
\begin{example}
  show dynamic_aperture
\end{example}


\index{dynamic_aperture}
Shows parameters and results of the dynamic aperture calculation.

%% show element --------------------------------------------------------------

\subsection{show element}
\label{s:show.element}

Syntax:
\begin{example}
  show element \{-attributes\} \{-base\} \{-data\} \{-design\} \{-all\} \{-field\}
      \{-floor_coords\} \{-no_slaves\} \{-ptc\} \{-taylor\} \{-wall\} \{-xfer_mat\} <ele_name>
\end{example}

This shows information on lattice elements. The syntax for \vn{<ele_name>} is explained in
section \sref{s:ele.list.format}. If \vn{<ele_name>} contains a wild card or a class name
then a list of elements that match the name are shown. If no wild--card or class name is
present then information about the element whose name matches \vn{<ele_name>} is shown.

If the \vn{-ptc} switch is used, then the associated PTC fibre information will be
displayed. If there is not associated PTC fibre (which will be true if PTC has not been
used for tracking with this element), an associated PTC fibre will be created. In this
case, only the PTC information will be displayed and the other switches will be ignored.

If the \vn{-attributes} switch is present, then all of the element ``attributes'' will be
displayed. The default is is to display only those attributes with non-zero
values. ``Attributes'' here does not include such things as the cross-section, Taylor map
and wiggler element parameters.

By default, the appropriate element(s) within the \vn{model} lattice (\sref{s:universe})
are used. This can be overridden by using the \vn{-base} or the \vn{-design} switches
which switch the lattice to the \vn{base} or \vn{design} lattices respectively.

If the \vn{-wall} switch is present, the wall information for the element, if it has been
defined in the lattice file, is displayed. For an x-ray \vn{capillary} element, the wall
is the inner surface of the capillary. For all other elements, the wall is the beam
chamber wall.

If the \vn{-data} switch is present, information about the all the datums associated with
the element will be listed.

If the \vn{-floor_coords} switch is present, the global floor coordinates at the exit end
of the element will be printed. See the \bmad manual for an explanation of the floor
coordinates.

When using wild cards in the element name, if the \vn{-no_slaves} switch is present,
\vn{super_slave} and \vn{multipass} slave elements will not be listed.

If the \vn{-taylor} switch is present, the Taylor map associated with an element, if there
is one, is also displayed. An element will have an associated Taylor map if tracking or
transfer matrix calculations for the element call for one. For example, if an elements
\vn{tracking_method} is set to \vn{Taylor}, it will have an associated Taylor map. To see
the Taylor map for an element that does not have an associated map, use the \vn{show
taylor_map} command.

If the \vn{-field} switch is present, any associated Electro-magnetic field maps or grid
data is printed. For example, wiggler terms for a \vn{map_type} \vn{wiggler} element are
printed.

If the \vn{-xfer_mat} switch is present, the 6x6 transfer matrix (the first order part of
the transfer map) along with the zeroth order part of the transfer map are printed.

The \vn{-all} switch is equivalent to using:
\begin{example}
  -attributes
  -field
  -floor_coords
  -taylor
  -wall
  -xfer_mat
\end{example}

Example:
\begin{example}
  show ele quad::z* -no_slaves  ! list all non-slave quadrupole elements with 
                                !   names beginning with "z".
  show ele q10w                 ! Show a particular lattice element.
  show ele -att 105             ! Show element #105 in the lattice.
\end{example}

%% show field --------------------------------------------------------------

\subsection{show field}
\label{s:show.field}

Syntax:
\begin{example}
  show field <ele> <x> <y> <z> \{<t>\}
\end{example}

The \vn{show field} command shows the electric and magnetic field at a point in
space-time. The \vn{<z>} coordinate is with respect to the beginning of the element
specified by \vn{<ele>}. The syntax for \vn{<ele>} is explained in section
\sref{s:ele.list.format}. In this case, \vn{<ele>} must specify a single element.
The \vn{<t>} argument is optional and will be set to zero if not specified.

%% show global --------------------------------------------------------------

\subsection{show global}
\label{s:show.global}

Syntax:
\begin{example}
  show global \{-bmad_com\} \{-csr_param\} \{-optimization\} \{-ran_state\} 
\end{example}


The \vn{show global} command, used without any optional switches,
shows information on the global parameter structure
(\sref{s:globals}). The optional switches are
  \begin{description}
  \item[-bmad_com] \Newline
Displays \vn{bmad_com} components (\sref{s:globals}).
  \item[-csr_param] \Newline
Displays \vn{csr_param} components (\sref{s:globals}).
  \item[-optimization] \Newline
Displays optimization parameters.
  \item[-ran_state] \Newline
Displays the state of the random number generator. Use this with the
\vn{set ran_state} command.
  \end{description}

%% show graph --------------------------------------------------------------

\subsection{show graph}
\label{s:show.graph}

Syntax:
\begin{example}
  show graph <graph_name>
\end{example}

Show information on a particular graph of a particular plot. See \sref{c:plotting} for the
syntax on plot, graph, and curve names.  Use \vn{show plot} to get a list of plot names.

Also see: \vn{show plot} and \vn{show curve} commands.

Example:
\begin{example}
  show graph r2.g1         ! Show the attributes of graph "g1" which is 
                           !   plotted in region "r2".
\end{example}

%% show history --------------------------------------------------------------

\subsection{show history}
\label{s:show.history}

Syntax:
\begin{example}
  show history \{-no_num\} \{<num_to_display>\}
\end{example}

Shows the command history. Each command is given an index number starting from 1 for
the first command. This index is printed with the command unless the \vn{-no_num} switch
is present.

The number of commands printed is, by defulat, the last 50. Setting the \vn{<num_to_display>} will
change this. Setting \vn{<num_to_display>} to \vn{all}  will cause all the commands to be printed.

Use the command \vn{re_execute} (\sref{s:re.exe}) to re-execute a command. 


If a command file has been called, the commands within the command file will be displayed
but will be proceeded by an exclamation mark ``!'' to show that the command was not ``directly'' executed.

Examples
\begin{example}
  show -write cmd_file hist all -no   ! Create a command history file
  show hist 30                        ! Show the last 30 commands.
\end{example}

%% show hom --------------------------------------------------------------

\subsection{show hom}
\label{s:show.hom}

Syntax:
\begin{example}
  show hom
\end{example}

Shows long--range higher order mode information for linac accelerating
cavities.

%% show key_bindings  --------------------------------------------------------------

\subsection{show key_bindings}
\label{s:show.key}

Syntax:
\begin{example}
  show key_bindings
\end{example}


Shows all key bindings.

%% show lattice --------------------------------------------------------------

\subsection{show lattice}
\label{s:show.lattice}

Syntax:
\begin{example}
  show lattice \{-0undef\} \{-all\} \{-attribute <attrib>\} \{-base\}
      \{-blank_replacement <string>\}  \{-branch <name_or_index>\}
      \{-custom <file_name>\} \{-design\} \{-floor_coords\} \{-lords\} \{-middle\}
      \{-no_label_lines\} \{-no_tail_lines\} \{-no_slaves\} \{-orbit\} \{-radiation_integrals\}
      \{-remove_line_if_zero <column \#>\} \{-s <s1>:<s2>\} \{-spin\} \{-tracking_elements\}
      \{<element_list>\} 
\end{example}

Show a table of Twiss and orbit data, etc. at the specified element locations. The default
is to show the parameters at the exit end of the elements. To show the parameters in the
middle use the \vn{-middle} switch.

By default, the appropriate element(s) within the \vn{model} lattice (\sref{s:universe})
are used. This can be overridden by using the \vn{-base} or the \vn{-design} switches
which switch the lattice to the \vn{base} or \vn{design} lattices respectively.

The \vn{-all} switch shows all tracking and lord elements.

The \vn{-orbit} switch will show the particle's phase space orbit which is the closed orbit if the
lattice has a closed geometry and is the orbit beginning from the specified starting position for
lattices with an open geometry. Use \vn{set beam_start} to vary the starting position in this
case. If the \vn{-spin} switch is also present, the particle's spin will also be displayed.

The \vn{-spin} switch will show the particle's spin which is the invariant spin if the lattice has a
closed geometry and is the spin beginning from the specified starting spin for lattices with an open
geometry. Use \vn{set beam_start} to vary the starting spin in this case. If the \vn{-orbit} switch
is also present, the particle's phase space orbit will also be displayed.

The \vn{-radiation_integrals} switch, if present, will cause the radiation integrals for
each lattice element to be displayed instead of the standard Twiss and orbit data.

If present, the \vn{-no_label_lines} switch will prevent the printing of the header
(containing the column labels) lines at the top and bottom of the table.  This is useful
when the output needs to be read in by another program. The \vn{-no_tail_lines} just
suppress the header lines at the bottom of the table.

If present, the \vn{-no_slaves} switch will veto from the list of element to print all
elements that are either a \vn{super slave} or a \vn{multipass slave}.

If present, the \vn{-lords} switch will print a list of lord elements only.

If present, the \vn{-floor_coords} switch will print the global floor (laboratory)
coordinates for each element.

The \vn{-branch <name_or_index>} option can be used to specify the branch of the
lattice. \vn{<name_or_index>} can be the name or index of the branch.  The default is the
main branch (\# 0).

The locations to show are specified either by specifying a longitudinal position range
with \vn{-s}, or by specifying a list \vn{<element_list>} of elements.  The syntax used
for specifying this list is given in section~\sref{s:ele.list.format}.  In this case there
should be no blank characters in the list.

The \vn{-tracking_elements} switch can be used to show all the elements in the tracking
part of the lattice. If neither \vn{-tracking_elements}, nor a range is given, the first
200 elements are shown.

To customize the output use the command \vn{show lattice -custom <file_name>}. A
customization file looks like:
\begin{example}
  &custom_show_list
    column(1)  = "#",                      "i6",     6 
    column(2)  = "x",                      "x"       1   ! blank space
    column(3)  = "ele::#[name]",           "a",      0
    column(4)  = "ele::#[key]",            "a16",   16
    column(5)  = "ele::#[s]",              "f10.3", 10
    column(6)  = "ele::#[l]",              "f10.3", 10
    column(7)  = "ele::#[beta_a]",         "f7.2",   7
    column(8)  = "1e3 * ele::#[orbit_x]",  "f8.3",   8, "Orbit_x| (mm)" 
    column(9)  = "lat::unstable.orbit[#]", "f8.3",   8 
    column(10) = "beam::n_particle_loss[#]", "i8",   8 
  /
\end{example}
each \vn{column(1)} has four components. The first component is what is to be displayed in
that column. Algebraic expressions are permitted (\sref{s:arithmetic.exp}). Note: Use of
\vn{ele::} and \vn{beam::}, etc sources is accepted but these constructs cannot be
evaluated at the center of an element. That is the \vn{-middle} switch will have no effect
on such constructs.

Instead of defining a custom file, the \vn{-attribute <attrib>} switch can be used as a
shortcut way for customizing the output columns.  When using the \vn{-attribute} switch,
the first five columns are the the same default columns of \vn{index}, \vn{name},
\vn{element key}, \vn{s} and \vn{length}. All additional columns are determined by the
\vn{-attribute} switch. Multiple \vn{-attribute} switches can be present and the number of
additional columns will be equal to the number of times \vn{-attribute} is used.  The
\vn{<attrib>} parameter for each \vn{-attribute} switch specifies what attribute will be
printed.  The general form of \vn{<attrib>} is:
\begin{example}
  attribute-name         or
  attribute-name@format
\end{example}
where \vn{attribute-name} is the name of an attribute and \vn{format} specifies the Fortran style
edit descriptors to be used. The default format is \vn{es12.4}. Example descriptors:
\begin{example}
  From   Example
  ----   -------
  Fw.d   F13.5    ! For real numbers. No exponent. 
  ESw.d  ES13.4   ! For real numbers. Has exponent
  Lw     L4       ! For logical numbers
  Iw     I8       ! For integers
  wX     4x       ! Whitespace. 
\end{example}
In the above, ``\vn{w}'' is the width of the field and ``\vn{d}'' is the number of digits to
the right of the decimal. Example:
\begin{example}
  show lat -attrib is_on@l4 -attrib voltage rfcavity::*
\end{example}
In the above example, \vn{-attribute} appears twice and the total number of columns of output will
thus be 7 (= 5 + 2). The sixth column will have the \vn{is_on} element attribute and will be printed
using the \vn{l4} format (logical with a field width of 4 characters). The seventh column will show
the voltage attribute.

To encode the element index, use a \vn{\#} or \vn{\#index}. To encode the branch index, use
\vn{\#branch}. Any element attribute is permitted ("show ele" will show element attributes or see
the Bmad manual). Additionally, the following are recognized:
\begin{example}
  x                          ! Add spaces
  #                          ! Index number of element.
  ele::#[name]                ! Name of element.
  ele::#[key]                 ! Type of element (``quadrupole'', etc.)
  ele::#[slave_status]        ! Slave type (``super_slave'', etc.)
  ele::#[lord_status]         ! Slave type (``multipass_lord'', etc.)
  ele::#[type]                ! Element type string (see \bmad manual).
\end{example}
If an attribute does not exist for a given element (for example, \vn{quadrupole}s do not
have a \vn{voltage}), a series of dashes, ``----'', will be placed in the appropriate spot
in the table.  Additionally, an arithmetic expression that results in a divide by zero
will result in dashes being printed. This behavior is changed if the \vn{-0undef} switch
is present. In this case, a zero, ``0'', will be printed.

Additionally, The \vn{-blank_replacement <string>} switch specifies that whenever a blank
string is encountered (for example, the \vn{type} attribute for an element can be blank),
\vn{<string>} should be substituted in its place. \vn{<string>} may not contain any blank
characters. Example:
\begin{example}
  show lat -cust custom.file -blank -- 1:100
\end{example}
This will replace any blank fields with ``--''.

Note: Data can be used in custom output but data is always evaluated at the exit end of an
element even when the \vn{-middle} switch is used.

The second component is the Fortran edit descriptor. The third column is the total width
of the field. Notice that strings (like the element name) are left justified and numbers
are right justified. In the case of a number followed by a string, there will be no white
space in between. The use of an "x" column can solve this problem. A field width of 0,
which can only be used for an \vn{ele::\#[name]} column, indicates that the field width
will be taken to be one greater then the maximum characters of any element name.

The last component is column title name. This component is optional and if not present
then \tao will choose something appropriate. The column title can be split into two lines
using \vn{"|"} as a separator.  In the example above, The column title corresponding to
\vn{"Orbit_x| (mm)"} will have ``Orbit_x'' printed in one row of the title and ``(mm)'' in
the next row.

If present, the \vn{-remove_line_if_zero <column \#>} switch will suppress any lines where
the value in the column given by \vn{<column \#>} is zero or not defined. Notice that when
specifying custom columns using the \vn{-custom} switch, columns that only insert blank
space are not counted. For example:
\begin{example}
  show lat -custom cust.table -remove 5
\end{example}
Assuming that the file \vn{cust.table} contains the example customization given above, the
fifth visible column corresponds to \vn{column(6)} which prints the element length. The
\vn{-remove 5} will then remove all lines associated with elements whose length is zero.

Example:
\begin{example}
  show lattice 50:100         ! Show lattice elements with index 50 through 100
  show lat 45:76, 101, 106     ! Show element #45 through #76 and 101 and 106.
  show lat q34w:q45e           ! Show from element q34w through q45e.
  show lat q*                  ! Show elements whose name begins with "q"
  show lat marker:bpm*         ! Show markers whose name begins with "bpm"
  show lat -s  23.9:55.3       ! Show elements whose position is between 
                               !   23.9 meters and 55.3 meters.
\end{example}

%% show matrix --------------------------------------------------------------

\subsection{show matrix}
\label{s:show.matrix}

Syntax:
\begin{example}
  show matrix \{-s\} \{loc1 \{loc2\}\}
\end{example}


Shows the transfer matrix for the \vn{model} lattice of the default universe (set by
\vn{set default universe}).  This command is equivalent to \vn{show taylor_map -order
1}. See \vn{show taylor_map} for documentation on the \vn{show matrix} arguments.

%% show normal_form --------------------------------------------------------------

\subsection{show normal_form}
\label{s:show.normal}

Syntax:
\begin{example}
  show normal_form \{-order <n_order>\} <type>
\end{example}


Shows normal form taylor maps (optionally truncated to <n\_order>) from Eq.~\ref{normalform1}
 and Eq.~\ref{normalform2}. <type> can be: \vn{M}, \vn{A}, \vn{A_inv}, \vn{dhdj}, \vn{F}, \vn{L}. 



%% show optimizer --------------------------------------------------------------

\subsection{show optimizer}
\label{s:show.optimizer}

Syntax:
\begin{example}
  show optimizer \{-geodesic_lm\}
\end{example}


Shows parameters pertinent to optimization: Data and variables used,
etc. 

If \vn{-geodesic_lm} option is present, parameters for the \vn{geodesic_lm} optimizer will
be shown. These parameters are shown in any case if the optimizer has been set to use
\vn{geodesic_lm}.


%% show opt_vars --------------------------------------------------------------

\subsection{show opt_vars}
\label{s:show.opt.vars}

Syntax:
\begin{example}
  show opt_vars
\end{example}


Shows the settings of the variables used in the optimization using the Bmad standard
lattice input format.

%% show particle --------------------------------------------------------------

\subsection{show particle}
\label{s:show.particle}

Syntax:
\begin{example}
    show particle \{-bunch <bunch_index>\} \{-particle <particle_index>
    \{-element <element_name_or_index>\} \{-lost\} \{-all\}
\end{example}


Shows individual particle information. The default for the optional \vn{-bunch} index is
set by the global variable \vn{global%bunch_to_plot}. The default \vn{-element} is 0 (the
starting position). Also see \vn{show beam}.

The \vn{-lost} option shows which particles are lost during beam tracking. Note: Using the
\vn{-lost} option results in one line printed for each lost particle. It is thus meant for
use with bunches with a small number of particles.

The \vn{-all} option shows all particles at the given element.

Examples:
\begin{example}
  show part -bun 3 -part 47 -ele 8 ! Shows information on particle #47 of 
                                   !   bunch #3 at lattice element #8.
  show part -bun 47 -part 8        ! Same as above except the default bunch is used.
  show part -lost -bun 3           ! Show lost particle positions for bunch #3
\end{example}

%% show plot --------------------------------------------------------------

\subsection{show plot}
\label{s:show.plot}

Syntax:
\begin{example}
  show plot \{-floor_plan\} \{-lat_layout \} \{<plot_or_template_name>\}
\end{example}

A simple \vn{show plot} displays which templates are being plotted and in which regions
and also all available templates. See \sref{c:plotting} for the syntax on plot, graph, and
curve names. A \vn{show plot <plot_or_region_name>} will display information on a
particular plot.

The \vn{show plot -floor_plan} and \vn{show plot -lat_layout} commands show the parameters
associated with the \vn{floor_plan} or \vn{lat_layout} plots (\sref{s:layout.and.floor}).
Use the \vn{set floor_plan} or \vn{set lat_layout} commands to set these parameters.

Also see \vn{show graph} and \vn{show_curve}.

Examples:
\begin{example}
  show plot      ! General plot info
  show plot r13
\end{example}

%% show top10 --------------------------------------------------------------

\subsection{show top10}
\label{s:show.top10}

Syntax:
\begin{example}
  show top10 \{-derivative\}
\end{example}

If the \vn{-derivative} switch is present, this command shows top dMerit/dVariable
derivatives, and Largest changes in variable value.  If not present, this command shows
top contributors to the merit function.

Note: To set the number of top contributors shown, use the command \vn{set global n_top10
= nnn} where \vn{nnn} is the desired number to be shown.

%% show taylor_map --------------------------------------------------------------

\subsection{show taylor_map}
\label{s:show.taylor}

Syntax:
\begin{example}
  show taylor_map \{-order <n_order>\} \{-s\} \{loc1 \{loc2\}\}
\end{example}

Shows the Taylor transfer map for the \vn{model} lattice of the default universe (set by
\vn{set default universe}).  See also \vn{show matrix}.

If neither \vn{loc1} nor \vn{loc2} are present, the transfer map is computed for the
entire lattice.

if \vn{loc1} and \vn{loc2} are the same, the 1-turn transfer map is computed. If the
s-position of \vn{loc1} is greater than the s-position of \vn{loc2}, the map from
\vn{loc1} to the end of the lattice with the map from the beginning to \vn{loc2} is
computed.

If the \vn{-s} switch is present, \vn{loc1} and \vn{loc2} will be interpreted as
longitudinal s-positions. In this case, if \vn{loc2} is not present, the map will be the
1-turn map if the lattice is circular and the map from the beginning to \vn{loc1} if the
map is not.

If the \vn{-s} switch is not present, \vn{loc1} and \vn{loc2} will be interpreted as
element names or indexes. The map will be from the exit end of the \vn{loc1} element to
the exit end of the \vn{loc2} element. In this case, if \vn{loc2} is not present, the map
will be the for the element given by \vn{loc1}

The \vn{-order} switch, if present, gives the limiting order to display. In any case, the
maximum order of the map is limited to the order set by the lattice file.

Examples:
\begin{example}
  show taylor -order 1 q10w q10e  ! 0th and 1st order maps from q10e to q10w
  show taylor 45                  ! Transfer map of element #45
  show taylor -s 13 23            ! Transfer map from s = 13 meters to 23 meters. 
\end{example} 

%% show twiss_and_orbit --------------------------------------------------------------

\subsection{show twiss_and_orbit}
\label{s:show.twiss}

Syntax:
\begin{example}
    show twiss_and_orbit \{-base\} \{-branch <name_or_index>\} \{-design\}
    \{-universe <ix_uni>\} <s_position>
\end{example}

Show Twiss and orbit information at a given longitudinal position \vn{<s_position>}. 

The default universe to use is the current default universe. This can be changed using the
\vn{-universe} switch.

The default is to show the \vn{model} Twiss and orbit parameters. The use of \vn{-base} or
\vn{-design} switches can be used to show parameters for the \vn{base} or \vn{design}
lattices.

The particular branch used in the analysis can be selected by the \vn{-branch} switch. The
root branch (branch 0) is the default.

Examples:
\begin{example}
  show twiss -uni 2 23.7     ! Show parameters in universe 2 at s = 23.7 meters.
\end{example} 

%% show universe --------------------------------------------------------------

\subsection{show universe}
\label{s:show.universe}

Syntax:
\begin{example}
  show universe \{universe_number\}
\end{example}

Shows various parameters associated with a given

universe. If no universe is specified, the current default universe is used. Parameters
displayed include tune, chromaticity, radiation integrals, etc.

%% show use --------------------------------------------------------------

\subsection{show use}
\label{s:show.use}

Syntax:
\begin{example}
  show use
\end{example}

Shows what data and variables are used in a format that, if saved to a file, can be read
in with a \vn{call} command.

%% show value --------------------------------------------------------------

\subsection{show value}
\label{s:show.value}

Syntax:
\begin{example}
  show value <expression>
\end{example}


Shows the value of an expression. Examples:
\begin{example}
  show value sqrt(3@lat:orbit.x[34]|model) + sin(0.35)
\end{example}


%% show variable --------------------------------------------------------------

\subsection{show variable}
\label{s:show.variable}

Syntax:
\begin{example}
  show variable \{-no_label_lines\} \{-universe <universes>\}            
         \{-good_opt_only\} \{-bmad_format\} \{<var_name>\}
\end{example}


Shows variable information. If \vn{<var_name>} is not present, a list of all appropriate
\vn{v1_var} classes is printed.

The \vn{-universe} switch is used to select only variables what control components in a
given universe or universes. Use \vn{-universe @} to select the current viewed universe.

If the \vn{-bmad_format} switch is used then the Bmad lattice parameters that the \tao
variables control will be printed in Bmad lattice format. This is the same syntax used in
generating the variable files when an optimizer is run. If \vn{-good_opt_only} is used in
conjunction with \vn{-bmad_format} then the list of variables will be restricted to ones
that are currently being used in the optimization.

If present, the \vn{-no_label_lines} switch will prevent the printing of the header
(containing the column labels) lines. This switch is ignored if \vn{-bmad_format} is present.

Examples:
\begin{example}
  show var             ! List all v1 variables.
  show var quad_k1     ! List variables in the quad_k1[*] array.
  show var quad_k1[10] ! List detailed information on the variable quad_k1[10].
  show var -uni 2      ! List all variables that control attributes in universe 2.
  show var -bmad       ! List variables in Bmad Lattice format.
\end{example}

%% show wakes --------------------------------------------------------------

\subsection{show wakes}
\label{s:show.wakes}

Syntax:
\begin{example}
  show wakes 
\end{example}

The \vn{show wakes} command will list the lattice elements that have associated wake
fields.  Use the \vn{show ele} command to get more details on a given element. Note that
wakes only affect particle tracking when tracking with a beam of particles (not when
tracking just a single particle which is the default for \tao). 

At this point in time, \tao is not setup to do multiturn tracking with bunches which means
that if simulations with wakefieds is desired, a different program have to be used.

%% show wall --------------------------------------------------------------

\subsection{show wall}
\label{s:show.wall}

Syntax:
\begin{example}
  show wall \{-branch <name_or_index>\}\{-section <index>\} \{-angle <angle>\}
  \{-s <s1>:<s2>\} \{<n1>:<n2>\}
\end{example}


The \vn{show wall} command shows the vacuum chamber wall associated with a lattice branch.

For the building wall, use the ``show building_wall'' command.

For showing the wall associated with a given element, use the ``show ele -wall'' command.

The \vn{-branch} switch is used to select a particular branch.

The \vn{-section} switch is used to show information about a specific chamber wall
cross-section. In this case, all the other options are ignored except for \vn{-branch}.

If \vn{-section} is not present, a list of vacuum chamber wall sections is presented. In
this case, the range of wall sections shown is given by \vn{<n1>:<n2>} except if \vn{-s}
is present in which case all sections within a range of \vn{s} values is given within the
range \vn{<s1>} to \vn{<s2>}. With each section, a wall radius is given. The angle in the
$(x,y)$ plane at which the radius is computed is determined by the \vn{-angle} option. The
default angle is 0 which corresponds to the $+x$ direction.

Examples:
\begin{example}
  show wall 45:100       ! Show vacuum chamber wall sections 45 through 100.
  show wall -s 10.0:37.5 ! Show wall sections that have S-position between 10 and 37.5.
  show wall -section 49  ! Show chamber wall section 49.
\end{example}

%% show wave --------------------------------------------------------------

\subsection{show wave}
\label{s:show.wave}

Syntax:
\begin{example}
  show wave
\end{example}

The \vn{show wave} command shows the results of the current wave analysis (\sref{c:wave}).

%-----------------------------------------------------------------------------------------------
%% single_mode --------------------------------------------------------------
\section{single_mode}\index{commands!single_mode}
\label{s:sing}

The \vn{single_mode} command puts \tao into \vn{single mode} (\sref{c:single}).
For on-line help when running \tao go to \vn{single mode} and type ``?''.
To get out of single mode type ``Z''.

%% spawn --------------------------------------------------------------
\section{spawn}\index{commands!spawn}
\label{s:spawn}

The \vn{spawn} command is used to pass a command to the command shell. Format:
\begin{example}
  spawn <shell_command>
\end{example}

The users default shell is used. \vn{spawn} only works in Linux and Unix environments.

Examples:
\begin{example}
  spawn gv quick_plot.ps &      ! view a postscript file with ghostview
                                ! (and return to the TAO prompt)
  spawn tcsh                    ! launch a new tcsh shell 
                                ! (type 'exit' to return to TAO)
  spawn ls                      ! Get a directory listing.
\end{example}

%% timer --------------------------------------------------------------
\section{timer}
\index{commands!timer}
\label{s:timer}

The \vn{timer} command is used to show computation time. Format:
\begin{example}
  timer start      ! Start (reset) the timer
  timer read       ! Display the time from the last \vn{timer start} command.    
  timer beam       ! Toggle beam timing mode on/off.
\end{example}
The timer has a \vn{beam timing} mode which can be toggled using the \vn{timer beam}
command. The initial state, when \tao is started, is for \vn{beam timing} to be off. With
\vn{beam timing} mode on, when \tao is tracking a particle beam through the lattice, \tao
will print, about once a minute, the element number and the elapsed time.

The \vn{timer start} and \vn{timer read} commands can be used to time execution
times. Example:
\begin{example}
  timer start ; call my_cmd_file ; timer stop
\end{example}

Note: \vn{timer start} will toggle \vn{beam timing} off.

%% use --------------------------------------------------------------
\section{use}\index{commands!use}
\label{s:use}

The \vn{use} command un-vetoes data or variables and sets a veto for the rest of the
data. Format:
\begin{example}
  use data  <data_name>
  use var <var_name>
\end{example}

\vskip 0.1 in 

See also the \vn{restore} and \vn{veto} commands.

Examples:
\begin{example}
  use data orbit.x             ! use orbit.x data in the default universe.
  use data *@orbit[34]         ! use element 34 orbit data in all universes.
  use var quad_k1[67]          ! use variable.
  use var quad_k1[30:60:10]    ! use variables 30, 40, 50 and 60.
  use data *                   ! use all data in the default universe.
  use data *@*                 ! use all data in all universes.
\end{example}

%% value --------------------------------------------------------------
\section{value}\index{commands!value}
\label{s:value}

The \vn{value} command is used to evaluate a value.  This command is in development...

%% veto --------------------------------------------------------------
\section{veto}\index{commands!veto}
\label{s:veto}

The \vn{veto} command vetoes data or variables. Format:
\begin{example}
  veto data <data_name> <locations>
  veto var <var_name> <locations>
\end{example}

\vskip 0.1in 

See also the \vn{restore} and \vn{use} commands.

Examples:
\begin{example}
  veto data orbit.x[23,34:56]  ! veto orbit.x data.
  veto data *@orbit.*[34]      ! veto orbit data in all universes.
  veto var quad_k1[67]         ! veto variable
  veto var quad_k1[30:60:10]   ! veto variables 30, 40, 50 and 60
  veto data *                  ! veto all data
  veto data *[10:20]           ! veto all data from index 10 to 20 (see note)
\end{example}

Note: The command `\cmd{veto data *.*[10:20]}' will veto all d1\_data elements within the
range 10:20 \textit{using the index convention for each d1\_data structure
separately}. This may produce curious results if the indexes for the d1\_data structures
do not all point to the same lattice elements.

%% wave --------------------------------------------------------------
\section{wave}\index{commands!wave}
\label{s:wave}

The \vn{wave} command sets what data is to be used for the wave analysis (\sref{c:wave}). 
Format:
\begin{example}
  wave <curve> \{<plot_location>\}
\end{example}

\vskip 0.1 in

The \vn{<curve>} argument specifies what plot curve is to be used in the analysis. The specified
curve must be visible in the plot window. Possible \vn{<curve>}s that can be analyzed are:
\begin{example}
  orbit.x, orbit.y
  beta.a,  beta.b
  phase.a, phase.b
  eta.x, eta.y
  cbar.11, cbar.12, cbar.21      ! Analysis not possible for cbar.21
  ping_a.amp_x, ping_a.phase_x
  ping_a.sin_y, ping_a.cos_y
  ping_b.amp_y, ping_b.phase_y
  ping_b.sin_x, ping_b.cos_x
\end{example}

The \vn{<plot_location>} argument
specifies the plot region where the results of the wave analysis is to be plotted. If not
present, the region defaults to the region of the plot containing the curve used for the
analysis.

Note: use the \vn{set wave} (\sref{s:set.wave}) command to set the boundries of the fit regions.

Examples:
\begin{example}
  wave orbit.x      ! Use the orbit.x curve for the wave analysis.
  wave top.x bottom ! Use the curve in top.x and the results of the 
                    !  wave analysis are put in the bottom region.
\end{example}

%% write --------------------------------------------------------------
\section{write}\index{commands!write}
\label{s:write}

The \vn{write} command creates various files.
Format:
\begin{example}
  write 3d_model \{<file_name>\}           ! Write a blender script for a 3D lattice display.
  write bmad_lattice \{<file_name>\}       ! Write a Bmad lattice file of the model
  write beam \{-ascii\} -at <element_list> \{<file_name>\} 
                                         ! Write beam distribution data (\sref{s:beamfile}).
  write blender \{<file_name>\}            ! Write a blender script (Same as 3d_model).
  write covariance_matrix \{file_name\}    ! Write the covariance and alpha matrices 
                                         !   from the Levenburg (lm) optimization.
  write curve <curve_name> \{<file_name>\} ! Write the curve data
  write derivative_matrix \{file_name\}    ! Write the \vn{dModel_Data/dVar} matrix.
  write digested \{<file_name>\}     ! Write a digested Bmad lattice file of the model.
  write gif \{<file_name>\}          ! create a gif file of the plot window.
  write hard                       ! Print the plot window to a printer.
  write hard-l                     ! Like "hard" except use landscape orientation. 
  write mad8_lattice \{<file_name>\} ! Write a MAD-8 lattice file of the model
  write madx_lattice \{<file_name>\} ! Write a MAD-X lattice file of the model
  write ps \{-scale <scale>\} \{<file_name>\}      
                                   ! Create a PS file of the plot window.
  write ps-l \{-scale <scale>\} \{<file_name>\}    
                                   ! Create a PS file with landscape orientation.
  write ptc \{-all\} \{-old\} \{-branch <name_or_index\} \{<file_name>\}
  write variable \{-good_var_only\} \{<file_name>\} 
                                   ! Create a Bmad file of variable values.
\end{example}

\vskip 0.1 in 

If \vn{<file_name>} is not given then the defaults are:
\begin{example}
  Command                        Default File Name
  ------------------             ------------------
  write 3d_model                 blender_lat_#.py
  write bmad_lattice             lat_#.bmad
  write beam                     beam_#.dat
  write blender                  blender_lat_#.py
  write curve                    curve
  write derivative_mat           derivative_matrix.dat              
  write digested                 lat_#.digested
  write gif                      tao.gif
  write mad8_lattice             lat_#.mad8
  write madx_lattice             lat_#.madx
  write ps                       tao.ps
  write ptc                      ptc.flatfile
  write variable                 global%var_out_file
\end{example}
where \vn{\#} is replaced by the universe number. \vn{write curve} will produce two or
three files:
\begin{example}
  <file_name>.symbol_dat    ! Symbol coordinates file
  <file_name>.line_dat      ! Curve coords.
  <file_name>.particle_dat  ! Particle data file
\end{example}
The particle data file is only produced if particle data is associated with the curve.
The curve coordinates are the the set of points that are used to draw the (possibly
smooth) curve through the symbols.

For \vn{ps} and \vn{ps-l}, the optional \vn{-scale} switch sets the scale for the
postscript file. The default is 0 which autoscales to fit an 8-1/2 by 11 sheet of paper. A
value of 1.0 will result in no scaling, 2.0 will double the size, etc.

The \vn{write 3d_model} or \vn{write blender} creates a script which can then be run by
the \vn{blender} program\cite{b:blender}.  \vn{Blender} is a free, open source, program
for creating, among other things, 3D images. This script will create a 3D model of the
lattice in the current default universe (\sref{s:universe}). The suffix must by '.py' and
if this suffix is not present it will be added. To run the script in \vn{blender}, use the
following on the operating system command line:
\begin{example}
  <path-to-blender-exe>/blender -P <script-file-from-tao>
\end{example}
To learn how to pan, zoom, etc. in \vn{blender}, consult any one of a number of online
tutorials and videos. A good place to start is:
\begin{example}
  https://www.blender.org/support/tutorials/  
\end{example}
Note: In order of the script to work, the script must be able to find the ``base'' file
\vn{blender_base.py}. This base file lives in the \vn{bmad/scripts} directory and the
\vn{bmad} directory is found using one of the following environmental variables:
\begin{example}
  BMAD_BASE_DIR
  DIST_BASE_DIR
  ACC_RELEASE_DIR
\end{example}
Generally, one of the latter two environmental variables will be defined.  If not, a copy
of the \bmad directory must be created and then \vn{BMAD_BASE_DIR} be appropriately
defined.

The \vn{write variable} command has an optional \vn{-good_var_only} switch.  If present,
only the information on variables that are currently used in the optimization is written.

\vn{write beam} will create a file of the particle positions when beam tracking is being
used. The \vn{-at} switch specifies at what elements the particle positions are
written. Element list format (\sref{s:ele.list.format}), without any embedded blanks, is
used for the \vn{<element_list>} argument to the \vn{-at} switch. The \vn{-ascii} switch
is for writing text files. The default is to write with a compressed binary format.  Note:
Beam files can be used to initialize \tao (\sref{s:command.line}). Example
\begin{example}
  write beam -at *   ! Output beam at every element.
\end{example}

The \vn{write ptc} command creates PTC lattice files (called ``flat'' files).  If the
\vn{-all} switch is present, there will be two main flat files generated. The \vn{-all}
switch needs to be used when there are multiple lattice branches that need to be
translated to PTC. For example, in a dual colliding ring machine with two storage rings.
Both \vn{M_u} and \vn{M_t} mad_universe structures will be generated. The two main files
generated will have the suffixes \vn{.m_u} and \vn{.m_t} appended to the file names. In
this case, the setting of \vn{-branch} is ignored.

If \vn{-all} is not present, only one main flat file is generated. In this case, if
\vn{-old} is present, the flat file generated will be of the ``old'' syntax. Generally
there is no reason to generate old style flat files. When generating a single flat file
(no \vn{-all} switch present), the flat file will contain the information for a single
lattice branch. The lattice branch used can be specified by the \vn{-branch} switch. The
default, if \vn{-branch} is not present, is to use lattice branch \# 0. The \vn{-old}
switch will generate an ``old style'' version.

In all cases, the \vn{write ptc} command can only be used after a \vn{ptc init} command
has been used to setup PTC.

Note: PGPLOT, if being used, does a poor job producing gif files so consider making a
postscript file instead and using a ps to gif converter.

%% x_axis --------------------------------------------------------------
\section{x_axis}\index{commands!x_axis}
\label{s:x.axis}

The \vn{x_axis} command sets the data type used for the x-axis coordinate. Format:
\begin{example}
  x_axis <where> <axis_type>
\end{example}

\vskip 0.1in 

The \vn{x_axis} command sets the \vn{plot%x_axis_type}. This determines what data is used
for the horizontal axis. Possibilities for \vn{<axis_type>} are:
\begin{example}
  index     -- Use data index
  ele_index -- Use data element index
  s         -- Use longitudinal position.
\end{example}
Note that \vn{index} only makes sense for data that has an index associated with it.

Examples:
\begin{example}
  x_axis * s
  x_axis top index
\end{example}

%% x_scale --------------------------------------------------------------
\section{x_scale}\index{commands!x_scale}
\label{s:x.scale}

The \vn{x_scale} command scales the horizontal axis of a graph or set of graphs. Format:
\begin{example}
  x_scale \{-gang\} \{-nogang\} \{<where>\} \{<value1> \}<value2>\}\}\}
\end{example}

Which graphs are scaled is determined by the \vn{<where>} switch. If \vn{<where>} is not
present or \vn{<where>} is \vn{*} then all graphs are scaled. \vn{<where>} can be a plot
name or the name of an individual graph withing a plot.  If \vn{<where>} is \vn{s} then
the scaling is done only for the plots where the x-axis scale is the longitudinal
s-position.

\vskip 0.1in 

\vn{x_scale} sets the lower and upper bounds for the horizontal axis.  If both
\vn{<bound1>} and \vn{<bound2>} are present then \vn{<bound1>} is taken to be the lower
(left) bound and \vn{<bound2>} is the upper (right) bound. If only \vn{<bound1>} is
present then the bounds will be from -\vn{<bound1>} to \vn{<bound1>}.  If neither is
present then an \vn{autoscale} will be invoked to give the largest bounds commensurate
with the data. If an autoscale is performed upon an entire plot, and if
\vn{plot%autoscale_gang_x} (\sref{s:template}) is True, then the chosen scales will be the
same for all graphs. That is, a single scale is calculated so that all the data of all the
graphs is within the plot region. The affect of \vn{plot%autoscale_gang_x} can be
overridden by using the \vn{-gang} or \vn{-nogang} switches.

Note: The \vn{x_scale} command will vary the number of major divisions (set by
plot%x%major_divisions (\sref{s:template})) to try to give a nice looking axis. The result
can be that if two plots have the same range of data but differing major division
settings, the \vn{x_scale} command can produce differing results.

Example:
\begin{example}
  x_scale                 ! Autoscale all x-axes.
  x_scale * 0 100         ! Scale all x-axes to go from 0 to 100.
\end{example}

%% xy_scale --------------------------------------------------------------
\section{xy_scale}\index{commands!xy_scale}
\label{s:xy.scale}

The \vn{xy_scale} command sets horizontal and vertical axis bounds. Format:
\begin{example}
  xy_scale \{<where>\} \{<value1> \}<value2>\}\}\}
\end{example}

\vn{xy_scale} is equivalent to an \vn{x_scale} followed by a \vn{y-scale}.

Which graphs are scaled is determined by the \vn{<where>} switch. If \vn{<where>} is not
present or \vn{<where>} is \vn{*} then all graphs are scaled. \vn{<where>} can be a plot
name or the name of an individual graph withing a plot.

\vskip 0.1in 

\vn{xy_scale} sets the lower and upper bounds for both the horizontal and vertical axes.
This is just a shortcut for doing an \vn{x_scale} followed by a \vn{scale}.  If both
\vn{<bound1>} and \vn{<bound2>} are present then \vn{<bound1>} is taken to be the lower
(left) bound and \vn{<bound2>} is the upper (right) bound. If only \vn{<bound1>} is
present then the bounds will be from -\vn{<bound1>} to \vn{<bound1>}.

If neither \{<bound1>\} nor \{<bound2>\} is present then an \vn{autoscale} will be invoked
to give the largest bounds commensurate with the data.

Example:
\begin{example}
  xy_scale          ! Autoscale all axes.
  xy_scale * -1 1   ! Scale all axes to go from -1 to 1.
\end{example}

